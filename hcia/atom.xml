<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ddn.org.cn/hcia</id>
    <title>小白的网络之路 Blog</title>
    <updated>2024-04-30T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ddn.org.cn/hcia"/>
    <subtitle>小白的网络之路 Blog</subtitle>
    <icon>https://ddn.org.cn/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[配置RIPv2的认证]]></title>
        <id>https://ddn.org.cn/hcia/mmu870hhcd</id>
        <link href="https://ddn.org.cn/hcia/mmu870hhcd"/>
        <updated>2024-04-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rip认证">RIP认证<a href="https://ddn.org.cn/hcia/mmu870hhcd#rip%E8%AE%A4%E8%AF%81" class="hash-link" aria-label="RIP认证的直接链接" title="RIP认证的直接链接">​</a></h3>
<p>简单验证是一种基于密码的身份验证方法。在RIPV2中，路由器使用预共享的密码对报文进行验证。发送方和接收方都必须知道相同的密码才能通过验证。这种方法对于简单的网络环境来说是足够的，但是密码可能会被截获或破解，所以在更安全的环境中，可以考虑使用MD5密文验证。</p>
<p>MD5密文验证是一种更安全的验证方法。它使用基于MD5算法的散列函数来生成一个固定长度的密文。发送方使用密钥和报文的特定字段计算出一个密文，并将其附加到报文中。接收方使用相同的密钥和相同的字段计算出一个新的密文，并将其与接收到的密文进行比较。如果两者相等，说明报文没有被篡改过。</p>
<p>总之，RIPV2支持简单验证和MD5密文验证两种方法，可以根据网络环境的安全要求选择适合的验证方式。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解配置RIPv2 认证的场景和意义</li>
<li>掌握配置RIPv2 简单验证的方法</li>
<li>掌握配置RIPv2 MD5 密文验证的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络场景。某公司有两台路由器R1与R2，各自连接着一台主机，并且R1和R2之间配置RIPv2协议学习路由条目。</p>
<p>R3模拟作为网络中的攻击者，窃取R1与R2间的路由信息，并发布了一些虚假路由，使R1和R2的相关路由的选路指向了R3，形成了路由欺骗。</p>
<p>为了避免遭受攻击，提高网络安全性，网络管理员将配置RIPv2认证。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" alt="1" src="https://ddn.org.cn/assets/images/1-f75dd4be5dd7f6ef5c6503c6318c985e.webp" width="800" height="459" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/table-68c5e857a78addd3eeed5c1c85ef93c4.png" width="864" height="490" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<p><em>根据实验编址表进行相应的基本配置，并使用ping命令检测各直连链路的连通性。其中，R3上的两个环回接口先不配置IP地址。</em></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip add 192.168.10.1/24 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip add 10.0.12.1/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/0]ip add 192.168.20.1/24 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-GigabitEthernet0/0/0]ip add 10.0.12.2/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip add 10.0.12.3/24 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="搭建rip网络">搭建RIP网络<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E6%90%AD%E5%BB%BArip%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="搭建RIP网络的直接链接" title="搭建RIP网络的直接链接">​</a></h3>
<p>配置公司路由器R1和R2的RIPv2协议，并添加需要通告的网段。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]rip 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-rip-1]version 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-rip-1]network 192.168.10.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-rip-1]network 10.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]rip 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-rip-1]version 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-rip-1]network 192.168.20.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-rip-1]network 10.0.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，检查R1与R2的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-bb137581c15fb9a247e03d2371e6423a.webp" width="1080" height="482" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-147d48c0669fa419812a0e567e4e2f43.webp" width="1080" height="488" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="模拟网络攻击">模拟网络攻击<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB" class="hash-link" aria-label="模拟网络攻击的直接链接" title="模拟网络攻击的直接链接">​</a></h3>
<p>配置路由器R3 作为攻击者，接入公司网络。</p>
<p>在基本配置中已经将接口GE 0/0/0 地址配置为10.0.12.3，与该公司路由器在同一网段，并配置RIPv2协议，通告该网段，配置完成后查看R3的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R3]rip 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-rip-1]version 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-rip-1]network 10.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-rip-1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/4-6da006e076bdaa1ed3cc30239ab9b7b3.webp" width="1080" height="450" class="img_ev3q"></p>
<p>观察发现R3已经非法获取了R1和R2上用户终端所在的两个网段的路由信息。此时R3就可以向两个网段发送大量的ping包，导致网络链路拥塞，形成攻击。</p>
<p>下面是 R3 模拟攻击演示，发送 10 万个 ping 包给 PC-1，导致攻击发生。可以按Ctl+C组合键来终止该操作。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R3]ping -c 100000 192.168.10.10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>完成上述模拟后，在 R3上分别配置两个用于欺骗的环回接口，地址分别为192.168.10.1和192.168.20.1，即与公司网络中两个用户的地址相同，并且在RIP协议中通告这两个欺骗的网段。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R3]interface loopback0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-LoopBack0]ip address 192.168.10.1 255.255.255.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-LoopBack0]interface loopback1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-LoopBack1]ip address 192.168.20.1 255.255.255.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-LoopBack1]rip 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-rip-1]version 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-rip-1]network 192.168.10.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-rip-1]network 192.168.20.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R1与R2的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/5-6f4002af992563b01f56c5de95dcf404.webp" width="1080" height="514" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/6-e7817967175a6527742f04deebe91e62.webp" width="1080" height="510" class="img_ev3q"></p>
<p>可以观察到R3发过来的路由更新。因为R2和R3发送RIP更新的cost都是1跳，所以在R1的路由表中，目的为192.168.20.0网段形成了两条等价负载均衡的路径，下一跳分别是R2和R3。</p>
<p>这样会导致去往192.168.20.0网段的数据包有部分转发给了欺骗路由器R3，R2的路由表变化和R1同理。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置ripv2简单验证">配置RIPV2简单验证<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E9%85%8D%E7%BD%AEripv2%E7%AE%80%E5%8D%95%E9%AA%8C%E8%AF%81" class="hash-link" aria-label="配置RIPV2简单验证的直接链接" title="配置RIPV2简单验证的直接链接">​</a></h3>
<p>为了提升网络安全性，避免发生上述攻击和路由欺骗，网络管理员可在R1和R2上配置RIP的简单验证实现对网络的保护。在路由器R1和R2 的GE 0/0/1 接口配置认证，使用简单验证方式密码为huawei。</p>
<p>注意，两端的密码必须保持一致，否则会导致认证失败，从而使得 RIP 协议无法正常运行。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]rip authentication-mode simple huawei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]interface GigabitEthernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2- GigabitEthernet0/0/1]rip authentication-mode simple huawei</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，等待一段时间，再次查看R1和R2的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/7-760016ff33f5cfefcfcd1c0d07c171d6.webp" width="1080" height="482" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/8-10117d8cdc95e945618b8f280a88cfda.webp" width="1080" height="491" class="img_ev3q"></p>
<p>可以观察到现在R1与R2的路由表恢复正常，R3发送的欺骗路由在路由表中消失。</p>
<p>原因是R1和R2配置了RIP认证，就要求在RIP更新报文中包含认证密码，如果密码错误或者不存在，将认为该路由非法并丢弃。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置ripv2-md5密文验证">配置RIPV2 MD5密文验证<a href="https://ddn.org.cn/hcia/mmu870hhcd#%E9%85%8D%E7%BD%AEripv2-md5%E5%AF%86%E6%96%87%E9%AA%8C%E8%AF%81" class="hash-link" aria-label="配置RIPV2 MD5密文验证的直接链接" title="配置RIPV2 MD5密文验证的直接链接">​</a></h3>
<p>在上一步骤中，在R1和R2上配置了简单验证方式的认证后，成功地抵御了R3的路由欺骗和攻击，且主机PC-1与PC-2可以正常通信。</p>
<p>但是通过抓包能够发现，简单验证方式下的认证安全性非常差，攻击者虽然无法直接攻击网络，但是可以通过抓取 RIP协议数据包获得明文密码，因此建议使用MD5密文验证方式进行RIPv2的认证。</p>
<p>在R1和R2的GE 0/0/1接口上删除上一步骤中的简单验证配置，选择使用MD5 密文验证方式配置。配置时可以选择MD5密文验证方式的报文格式，usual参数表示使用通用报文格式;</p>
<p>nonstandard参数表示使用非标准报文格式(IETF标准)，但是必须保证两端的报文格式一致，这里选用通用标准格式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]undo rip authentication-mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]rip authentication-mode md5 usual huawei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/1]undo rip authentication-mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/1]rip authentication-mode md5 usual huawei</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R1和R2路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/9-89136b5e670f6ffccd8c2658e5c3f5fd.png" width="1080" height="484" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/10-68043d1920e333851f2676ed4be599d4.png" width="1080" height="479" class="img_ev3q"></p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="RIP" term="RIP"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[RIP路由协议基本配置]]></title>
        <id>https://ddn.org.cn/hcia/jklzzbnfg65e</id>
        <link href="https://ddn.org.cn/hcia/jklzzbnfg65e"/>
        <updated>2024-04-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rip">RIP<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#rip" class="hash-link" aria-label="RIP的直接链接" title="RIP的直接链接">​</a></h3>
<p>RIP(Routing Information Protocol，路由协议)作为最早的距离矢量IP 路由协议，也是最先得到广泛使用的一种路由协议，采用了Bellman-Ford算法，其最大的特点就是配置简单。</p>
<p>RIP 协议要求网络中每一台路由器都要维护从自身到每一个目的网络的路由信息。RIP协议使用跳数来衡量网络间的“距离”:从一台路由器到其直连网络的跳数定义为 1，从一台路由器到其非直连网络的距离定义为每经过一个路由器则距离加1。“距离”也称为</p>
<p>允许路</p>
<p>由的最大跳数为15，因此，16即为不可达。可见RIP协议只适用于小型网络。</p>
<p>目前RIP有两个版本，RIPv1和RIPv2，RIPv2针对RIPv1进行扩充，能够携带更多的信息量，并增强了安全性能。RIPv1和RIPv2都是基于UDP的协议，使用UDP520号端口收发数据包。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解RIP 的应用场景</li>
<li>理解RIP 的基本原理</li>
<li>掌握RIPv1的基本配置</li>
<li>掌握RIPv2 的基本配置</li>
<li>掌握测试RIP 路由网络的连通性的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>某小型公司组网拓扑很简单，只拥有两台路由器，因此可以采用RIP路由协议来完成网络的部署。</p>
<p>本实验通过模拟简单的企业网络场景来描述RIP路由协议的基本配置，并介绍一些基本的查看RIP信息的命令使用方法。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="data:image/webp;base64,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" width="718" height="324" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1oAAAD9CAIAAAAqMZECAAAACXBIWXMAABJ0AAASdAHeZh94AAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AACAASURBVHic7d2/i9vY/vj/137Zv8EwggzsVNsEDCq2SEgfBcG429TX7BCrMFMYQ6pUAWP4+rrQhAnTJ9XVgBhtvyRF4AoMadK8HfCAzNU/MZ9Csi1Zki177Bnb5/lolrF1zpxlXpFe5+j8+OXu7k4AAACgqv/vsRsAAACAx0Q6CAAAoDTSQQAAAKWRDgIAACiNdBAAAEBpv0b/GQ6Hj9sOAAAAbM/JyUnRV7+WuQi7bzgc8hfEDiIyoSDCHjto8cAfL4sBAACURjoIAACgNNJBAAAApZEOAgAAKI10EAAAQGmkgwAAAEojHQQAAFAa6SAAAIDSSAcBAACURjoIAACgNNJBAAAApZEOAgAAKI10EAAAbFXonGnamRPmfef3NE3r+w/dJKSomw76vcLQxIHw+8X3mNA507Qe9x9Aon8q9eui2+GiBzlwX2PnQ1eMi9f6YzdEcXuWDvq97NPd72v5FvU1/L7ZFZHR7XibzcUOO/7dkK65KEjGTr0gtArUHcIJK4vuYHORmH9bK8jYFiZzY6e+KNUDHpn/2fKk/ea0sk7ZXvH9mA7Min597AasxP/SlU5X+34xuJoLnZYbnCe6FmOnrluF1YydutkREXE7pttZ8PvabtCkw3Ig/L5mZv/YHVNLfmgsDa2i2nua2b1vE4HFvEZV+9seXNbWeXICuyJ0zqqWm/xk7k4cmTyBx05dt7xsNS03OA+C84L6fz/mn8lK9mt0UG8GA9sUr1Gd6+wavz0pW0cisNpukM9tR98/Jxc8HHozCIJgYJuG7Wf+4K04GOZzQeAxpW9R0X3JtapLJjkseLcbOmcLRhmBh1GpXc7uvSLxPdltiZj2YBbxk9GYo9pV/MnANkVak38W57rkz/u6HbmrZAUQkX1LB0WkUrsc2KbxdPqH9r90RJ4+KfcUj3JB0x4EgduSjpn3di8eRWJkcH/Fz7xoNLBjapqWnCboWe/S9w6/b3al85E3C9htenNwYYiIdL+sOunVa1Q1TdO06uilbZS/YQL3Fl5Hk26qliviWtXk1Ai/b3bFuHhfOxIR0f+0Ddd6u6Cv4n+yXGm/SD6Zw9EPkbmBwJWyAkzsXTooIpXa5VVTr4hMXvuadpk5qOF1XYtywctaRUQ/D9yWZ+mpOTt+T9PMjrTcgFxwj026nm5bpgMs8QvfSu3SbafuOH7f7IjJCzjsgcofr4zEj5OJU2ZnmvClhkn8vqZpuuWJGBfxmEvzj3K/ye8zFxYbUTm9mg3sxYN/k1fAZkda7tWpxOPZR7Urt+013hYFnv9Pp8xbu/D2u4hxrG36/+TQ7WM6GIvTOzHsd5kH+VHtTWsyLBS/GQlvf8rcU18/DwK33TE17cwJx05d08yuYftBmbli2Fv66wvD+3kb/eD3zE5uCAE7Tz+fvUWOE77LWkVuR/EwzIdjPwh8O5lBSjBKzMGaLlhJJJRs+IGH4Pej0Zm5p63eDNynlp7XFRk7H7oirblsMOe98O1PT+Tp8dEWWn3Q9mYpSXKqvnExuDqVW3lqyNM3BcN4emaGqX5+FcxfFTofozUlVtWd/w4HJDtz2dNmKz88S9cmK4+YJIDdFX678UTEPC6cFTVdMTXt+i4a4dObQdCcFEst0ctmhK5VdRPr88otsQJyRLO2ikJIbwa+U9e1Ufpe7H+2PDHsP9NFxqPv8++Fw9GPhf9GUGBv0sE4vZstGa7op82r07XqSqwxbbtBcJn+Ks4MSAsOSaV2GdQSf2i/p5k/eEGMfTLtErf/Ko5bvRkEr52zavHGCrLmezQmVGAzQuedJaYhXVNL7caQ7m+IeKbWmaaM8d5wia57YUDejlyRFsuKV7Y36WCe7JDPvFlOl9xmpOXGXeKsaW9Z/L6mmfGnhu1f1Rh53lO3Tt28eZX8C8YvHbhfYMfl7L5hXAzop2J/fe1Vrd/d4MUXzfUmD+jQOataMk3vMmPV073hJimg39PMHyIST37wsv9O4lyTYZ0V7HU6WKldDkSSYTTj9zSzm+gEp96KzHVKChFK+yu8rlcbnoh0/pZBcJV6l/DtJuelA7DrNnBDiibjM60KD2s6HmON/goCXcT/skLhz5bXcl0x4xQwaTaCM2f5aBHm7HU6KCKVZy8NaVif/qqlbpPxoTfvi4b00rfVua5JXMOijayx0/y+ZnZabuA+1cxO+69aJW8P6sR8wSS6ANgdG4zGr33N6sSVEuF4OOF1vdoQ2x/Y76qWpLYBSY9+p14WJ9c/6edBIOL3tt9Wte3xyuJI5fRNW+Y2jQudd+sfeoP9pzeDueXh0R7Uk71nWun9x5P70ZAL4jA9m/wTCJr64hOKgU2qnF4FQf5sq8ldN7kHzewciA1gQckq9n10UET0ptvumNbbl8+iqQZ+r2q5S3rAeQfizM9jFZGnm20pHlnonJkdabupTDHed5Dj07H//L724dh/X+ZS7+etSKbDHA2jt9zgxeYbB2xY/smjIiJtd3D8wI3Zf3s8Ohhe9+OtifSm2xKvUe37El7Xze7y2dbps5/muiZBEGQ268IBGN8ev2xPjynp+zJLEFkyiT3nNaqa9uG4zKK38eh78mDPsVOf7jv48XgwP7IObMtkb+DkgSWT46TyT59Lm771yWjqtyMmDq5oT0cHb6NZom23KdHhNucD+0fVMjVOl0OhI10/1YPTpkQrjeIRYsP2F8bL/G4IwO6YzJdfsAvMUe0qqKU+CUaeSPtJZXKAu2H7wRWLS/DgClYWR0LnLHP6XHLzS1OW+53tI1awl+mg1zC9ubTP/zRdQ9Qx66W6yFCX/2VuD+oFT9Ny2+0mt0kHHkTonFWt393gci4+owV2N1/f1fJug9He+9FJX5lMEXgYhSuCp25Hrhgv03P/shvNFPG/dGT+tBIstmfpoP/Z8kRSqWDcwZ0+tv2+Zi55wDN3UA3Zkyunu8+kRlPGTl23qq5lJHe6Ah5I7oNx+dMy3lw994vT9/bf1YK187LgDcrsH4iIzK++n7tDshsrVpc/XFc5/l2kO7q9TMxm9b90ojHs0uaiV1ou9/PV3N3d3d3d/d///d/dXgj+86+//vO/u7u7u7v/Of86ivz//52/7L//jr86+vf8d//9d96neb+ozGU7Y2/+gg/hf//56ygVG9N4yIbKzH//veQCrIPIhIII+5nZ4/hf/wmWXzT1L+d/D9lMFSwOy1/u7u5EZDgcnpycPHZqWl68oGjZNMH4MhVGffbtLwhVEJlQEGGPHbQ4LPfsZfFEmTcp5S8DAABQ1x5vNAMAAID7Ix0EAABQGukgAACA0kgHAQAAlEY6CAAAoDTSQQAAAKWRDgIAACiNdBAAAEBppIMAAABKIx0EAABQGukgAACA0kgHAQAAlPbL3d2diAyHw8duCQAAALbl5OSk6Ktfy1yE3TccDvkLYgcRmVAQYY8dtHjgj5fFAAAASiMdBAAAUBrpIAAAgNJIBwEAAJRGOggAAKA00kEAAAClkQ4CAAAojXQQAABAaaSDAAAASiMdBAAAUBrpIAAAgNJIBwEAAJRGOggAAKA00kEAAAClkQ7ikPk9bebMCctd3/dTn/UTddSvl9axmUpwIMZOXas748LvVw3R+xcs17BUxG6hfiAhHW4l7pChc6Zpmqb1/GVXoizSQRyq0DnTzG7iA9eqLnk++V+6ItJ+rk8+GDt1zewkrvAa1WWPxo1UgkMQXtc13fKKv189RO9ZsFzD/L6WjtgN1w8k+L35cFt+h/Q/We6Wm6Ue0kEcpvD6reWKSNsNIgPbFBHP+lzYmwyvP3REjIvXk0QudN5Znoi0JnX4tiEirvWpuEe6kUqw98ZOXdOqjUUZ0Rohes+C5RoWOh87IobtBxNuW0TEs96V6MOU+B8HZsbOh66IaQ/mws213haOEUYhig0jHcRB8j81PBHD9puTtKxSe2cbItL9UDDIEX792xMxXv1RmdZhuSKmPTif1HFUe39hiEjnY9FzcSOVYL/NxsZatm0WXbVGiN6zYMmGibx0g+CqdjT9WW9Gj2h3dLuo+tL1Awmv3CC4rFWmP0/CzfuZH25Rd6jdaj9Q+5RBOohD5H/piEjrTeKRJnJUe9MSEW8U5Bb5ZLmpIv4/HRFp/5W4T4lUTt8sei5upBIcgrYbBMH5s8Lv1wjRexYs2TCp1E714m/vXz+QcFSrrRZu/qeGJ6b9+sWWGqQu0kHsm7FTT8w5dsaTaciJOcXh7XcRMX57Mlf0yW+GiHy/zRmVi/O2F9M7Uzj6ISLGsTZfx7EpIt9HecMwG6kE+65yehUEzcXPuDVC9J4FSzbsPrZdP+D3zI4Y9rtUBxsbQTqIfZKZou5Zet3JDLLd/vRE5OmT+TtG5clTyX8HkVn/IbcjV0SeHh/NXVk5/l0KhmE2UgmUsHqI3rfgfUQzYqX1nFQP2xdPDUz0qyf8vtnNDI1jQ3597AYApY2dtw1PRIyLwdVp/Dj0e5p573nrmfUfj1YJsHP8frXhibTdc0IbW+f3qpYr0nIz48x+3+wQh9vD6CD2hv85XqI7zQVFRD8P3NY9K86s/3i0SoDdEl5HuyQlV64AWzLZQSm59m72VZQMEofbQjqIfRHPw7P/nL8b6C/ut8Qss/7j0SoBdojfj7aMMe1BaqExsAV+X9OqlivGxSC10FhEJquJjYsByeD2kA5iXxTNwyuUnVafOw0/s/4jVUdmtUf+6pCNVALVlAzRDRYsa7J3entuExBgCyaD0G03CJIvf2LRdAXTfp/9CptDOoh9UbgaN3oQpi79zZC8afV50/Cz6z+Svy672iM3K91IJVDIKiG6mYIrGDt13fKk7bJOGNsXXterDU9aReE22XTatarJk+yig0y6ppY9ExRrIR3EvohX4958mxsXiSbtpS/945UhIt0v6XtETtJWvP6j8uylISKdf+bryC6x3EglUEr5EN1UwdKic3TaLqkgHkC0QLDlBiwQeWykg9gb0RxBr1FNHHAeOmfVnMMr4115O+bs4Mt4JnI6aVu0/iPeLLprzn7d2KlH0+pT8xc3UgkUUzZEo001E4MfJQtG23OucTT2+OuNW6avkmkYsLrw241XOM0mUqldBjmis+ziwz/pumwA6SD2h96MFhF7jelLg6rltl03ZymJfh4dqzV9v1CNDotLzT5Zsv5Db7rt1K/TLU/EuHifun4jlUA95UL0S0dEpJMcDCxTMHrKinvzddWtzoORJ9N3cBnTzd7zGgasKprk0CkIN3obD4l0EPtEPw8GF8bsZ9MeFPYL9WYwSB6cml2wtnD9x6QO3078PsP252c6b6QSKGl5iIr+vC2SeQu8vGD8Ttl89WzFXkd2Jm5B23MbBqwkWlSHnfDL3d2diAyHw5OTk8duDNan8l/Q72lmN7U3dclyfc3s3HeO1EYqOWQqRyaURdhjBy0OS0YHse+iSfQrr6nkJBIAACKkg9gfY6eu1Z3x3CdmR0RMe8WMjJNIAACIcWYx9otn6Zo1/6Fhv1t1p9xK7TKoXd6zMRupBACAR8boIPbHUe0qPYNeokn0nKAFAMA9MDqI/cKAHAAAG8boIAAAgNJIBwEAAJR2EOlgdBzTGhuaZ1eqAgAAKOYg0sECHTNxpFJGeF2PjgsDAABQ2QGlg6Y9SBxvHR9l1v2QM/g3duqaVm2QCgIAABxSOphWOb1yWyLi3XwLk5/PBgVb9tyWJQAAAAo62HRQRJ78ZhR803aDIDh/9qCtAQAA2EmHvO/g7U9PMkfZVk6vgtNHahAAAMDuOdjRQb+nmd01jrIFAABQywGNDrpW1U0fZmvag8tVj7LdY8Ph8LGbAOQgMqEgwh775YDSwbS2GzQVGxc8OTl57CYA84bDIZEJ1RD22EGLuygH9LJ4utGMbxsiHVOrX4fLSwEAAKjtgNLBqaPalW8bIl7jLSeOAAAALHaI6aCIHNXetETEsz4vPagOAABAaQeaDoro525bRLrm8pOLAQAAFHaw6aCI/vrCEJHOR4cphAAAAEUOOB2Uyumbtoi41lvWlAAAABQ45HRQRG+6bWFNCQAAQLFf7u7uhE2S9h9/QewmIhMKIuyxgxaH5WGPDgIAAGAJ0kEAAAClkQ4CAAAojXQQAABAaaSDAAAASiMdhML8vqZpWo+DawAASiMdBLKiPDFWZxtzbJTfW9gJGTv1RPitcMzm2gVLNmwLBQGRuTtumVtu6JxpdOY3i3QQSBs7dc3sJD7wGlXtjKMOsRF+X9PM7sLvdctLfNAxyz3z1i5YsmGbLwiIRH2J1B23xC3X/2S5W26WekgHgaTQeWd5ItJyg4hvGyLiWp/oheJ+/J42/9zLXNI3OyJiXAzi8HPbIiLdD8vOVVq7YMmGbbggEBs7H7oipj0J3EnoLjpdNnQ+EnSbRzoIJESdTtMenOvxJ0e19xeGiHQ+MkCItU2H0Az7ol10UXj9oSMiLffqtBJ/pDfdloh41udF3ZG1C5Zs2EYLAimv3CC4rFWmP+vNKCP0ft7mXh9ev7VcabeIug0jHQRm/H86ItL+K3FvEqmcvmmLiDvKvzkB5RgXgyC4qj0p+j78+rcnYth/6slP9T9tQ0R+jIp7I2sXLNmwzRcEYke1mr78qgT/U8MT0379YksNUhfpIDAVjn6IiHGszX3+5NgUke+jEu/dgDx6MwhmQ3f5bkeuiDw9Pkp/fHT8VBb3RtYuWLJhmy0IrM/vmR0x7Hc1Im/jSAeBqYLHqlSOfxcRbxQ8QpugivHou4iYx5mxtmW9kbULArsonhrYfpEZNvT7Zlek9aY2f4vGBpAOAgCAneD3qpYr0nKb89lgtF6q7Z6v9nYZJZEOAgCARxc6Z5rZTS/mm30VJYOZLBEb8utjNwAAAKjN72uTzZKyc1Kj1cTGxYBkcHsYHQTmZOdaFS0xATYtZ+VH0ZTWDRUEHlt4He3933Zz1yf5/WrDE9N+z9KlbSIdBKaiqffZJSM8VrF90ULgbG+kcKXIvQsCOyC8rlcbnrTcIMgd+5tsOu1a1eRJdtH2511z3RMZMY90EJiqPHtpiEjnn/S9xf/SEZHWc15TYJv05y0R8W6+pTYKDL/deCLGy2fFAyNrFwQe29h5G+WCLBB5bKSDwEy843TXnJ2hPnbqZie7xy+wcdHG0V6jOhvriF6TSftN4jVZeF3XNK2eOMJr7YIlrV0QWCzqtOTsKTNTqV0GOaKz7OLTRJlSuAGkg0CS3ozOR2pM3kvolidiXLxnpyts3fRERDP1Riy9mjI6g0S8v7+G9y9YytoFgSVuf3qSjNs03gE/JNJBIE1vBr5tzH42bJ/TF/BAKqdX8bBHrJ2ZURVPaZh7C7x2wTKNWrcgsFi0Sg874Ze7uzsRGQ6HJycnj90YrI+/IHYTkQkFEfbYQYvDktFBAAAApZEOAgAAKI10EAAAQGmkgwAAAEojHQQAAFAa6SAAAIDSSAcBAACURjoIAACgNNJBAAAApZEOAgAAKI10EAAAQGmkgwAAAEojHQQAAFAa6SAAAIDSSAcBAACU9svd3Z2IDIfDx24JAAAAtuXk5KToq1/LXITdNxwO+QtiBxGZUBBhjx20eOCPl8UAAABKIx0EAABQGukgAACA0kgHAQAAlEY6CAAAoDTSQQAAAKWRDgIAACiNdBAAAEBppIMAAABKIx0EAABQGukgAACA0kgHAQAAlEY6CAAAoDTSQQAAAKWRDuKQ+T1t5swJy13f91Of9RN11K+X1rGZSnAgxk5dqzvjwu9XDdH7FyzXsFTErlL/2gWhsHTUlLhDhs6Zpmma1vOXXYmySAdxqELnTDO7iQ9cq7rwwSzif+mKSPu5Pvlg7NQ1s5O4wmtUlz3hNlIJDkF4Xdd0yyv+fvUQvWfBcg3z+1o6YsvWv3ZBKMzvzUfN8juk/8lyt9ws9ZAO4jCF128tV0TabhAZ2KaIeNbnwt5keP2hI2JcvJ4kcqHzzvJEpDWpw7cNEXGtT8U90o1Ugr03duqaVm0Up4Jrheg9C5ZrWOh87IgYth9MuG0REc96t7gPs3ZBKGzsfOiKmPZgLmpc623hGGEUadgw0kEcJP9TwxMxbL85ScsqtXe2ISLdDwVjFeHXvz0R49UflWkdliti2oPzSR1HtfcXhoh0PhY93jZSCfbbbOytZdtm0VVrhOg9C5ZsmMhLNwiuakfTn/Vm9Ih2R7eLqr9HQSjslRsEl7XK9OdJ1Hg/86Mm6g61W+0Hap8ySAdxiPwvHRFpvUk8mUSOam9aIuKNgtwinyw3VcT/pyMi7b8S9ymRyumbRY+3jVSCQ9B2gyA4f1b4/Rohes+CJRsmldqpXvztAmsXhMKOarXVosb/1PDEtF+/2FKD1EU6iH0zduqJOcfOeDINOTGnOLz9LiLGb0/mij75zRCR77c5o3Jx3vZiemcKRz9ExDjW5us4NkXk+yhvGGYjlWDfVU6vgqC5+Bm3Rojes2DJhgG7zO+ZHTHsd6kONjaCdBD7JDMF3rP0upMZZLv96YnI0yfzd4zKk6eS/w4is/5DbkeuiDw9Ppq7snL8uxQMw2ykEihh9RC9b8H7iGbESuv5qqnk2gWhsHhqYKJfPeH3zW5maBwb8utjNwAobey8bXgiYlwMrk7jx6Hf08yFE/bLyKz/eLRKgJ3j96sNT6Ttnq8Y2msXhML8XtVyRVpuZhzb75sdwml7GB3E3vA/x0t0p7mgiOjngdu6Z8WZ9R+PVgmwW8LraJek5MqV7RaEwiY7KCXX3s2+ipJBwmlbGB3Evojn4dl/zt8N9Bdt6d5j34HM+o9HqwTYIX4/2g7OtAeXK03VWrsgFDaJmuTLn6loNbFxMSAZ3B5GB7EviubhFcpOq8+dhp9Z/5GqI7PaI391yEYqgWpKhugGC5Y12Tu9PbcJyPYKQmGTseS2GwTZXDCedWDa77NfYXNIB7EvClfjRg/C1KW/GZI3rT5vGn52/Ufy12VXe+RmpRupBApZJUQ3U3AFY6euW5603VXXIa9dEAoLr+vVhietoqiZbDrtWtXkSXbRQSZdU8ueCYq1kA5iX8SrcW++zY2LRJP20pf+8coQke6X9D0iJ2krXv9RefbSEJHOP/N1ZFdKbqQSKKV8iG6qYGnROTptd+WMbu2CUFi0QLDlBiwQeWykg9gb+ou2iHiNauKA89A5q+YcXhnvytsxZwdfxjOR00nbovUf8WbRXXP268ZOPZodn5q/uJFKoJiyIRptqpkY/ChZMNqec42jscdfb9wyfZVMw8oWBGbCbzde4TSbSKV2GeSIzrKLD/+kB7IBpIPYH3ozWkTsNaYvDaqW23bdnNOK9PPodKzp+4VqdFhcavbJkvUfetNtp36dbnkixsX71PUbqQTqKReiXzoiIp3kYGCZgtFTVtybr6tudR6MPJm+g8uYbvaebVjJgkBCNMmhUxA1vAN+SKSD2Cf6eTC4MGY/m/agsF+oN4NB8mBW42IwN7d94fqPSR2+nfh9hu3Pz3TeSCVQ0vIQFf15WyTzFnh5wfidsvnq2Yq9juxM3IK2zzesbEFgJlpUh53wy93dnYgMh8OTk5PHbgzWp/Jf0O9pZjd/e4LF5fqa2bnvVKeNVHLIVI5MKIuwxw5aHJaMDmLfRZPoV15TyUkkAABESAexP8ZOXas747lP4g1vV8zIOIkEAIAYp5Jgv3iWrlnzHxr2u1U3vK3ULoPa5T0bs5FKAAB4ZIwOYn8c1a7SM+glmkQfXLFKFwCAtTE6iP3CgBwAABvG6CAAAIDSSAcBAACUdhDpYHQc0wobmkfHK02scY4TAADAoTiIdLBAx8w7Gcnva9HWJFOuVZ3bvgQAAEAZB5QOmvYgcbx1fJRZ90M6zwudj53olLD0Odie9Y4xQgAAoKIDSgfTKqdXbktEvJtv6TTvpZvel0RvRhmhO7p92BYCAADsgoNNB0XkyW9G5rNK7ZTjxAAAAGYOOR28/enJ6kfZAgAAKOVg00G/p5ndUkfZhtcfOiLSes6wIQAAUNABnUriWlU3fZitaQ8ulx1l6/erDU+k7Z7vfTY4HA4fuwlADiITCiLssV8OKB1Ma7tBc/m4YL3a8EQM21967R44OTl57CYA84bDIZEJ1RD22EGLuygH9LJ4utGMbxsiHVOrXy/YOsbva1q14YlpD1ILjQEAANRyQOng1FHtyrcNEa/xNn9z6bFT18yOSNsNgqVvkwEAAA7aIaaDInJUe9MSEc/6nDmVZOzUdcuTthssf5sMAABw8A40HRTRz922iHTN9MnFofMuygVJBQEAAEQOOB0U0V9fGCLS+Zg4fW789cZlTxkAAICZA04HpXL6pi0irvV2uqYkGHki0jW1XL3Mm2UAAIBDd8jpoIjedNuSWFMS3n5/5BYBAADsmIPYd/CodhXU8r/Sm0HQnP5UOb0KTh+oUQAAAHvhsEcHAQAAsATpIAAAgNJIBwEAAJRGOggAAKA00kEAAAClkQ5CNaFzpmlaPf88awAA1EM6CCwSXtcTO5X32akc9+f3Fm56P3bWjLl1C6aD/CEKAil+PxlI9etwWYGoV8/hEZtEOggU8ntateElPuiYPPNwL35f08zuwu91az7myjzz1iwYOmdzQb7tgkCK39M0s5P8xGtUtTNnUUrof7LcLTdLPaSDQAG/b3ZFxLD9IOK2ROZOwQZK83va/HMvc0nf7IiIcTGYxFxbRKT7YdnchnULRo/VlhtMDC4MEZGuuaTbs3ZBIGnsfOiKmPZgGklR6CZPl50XOh8X/jPCWkgHgVzxHaftXtWO4o/0czc6BfsTDzysZjooaNgX7aKLwusPHRFpuVenlfgjvem2RMSzPi+KubULihzbfhCc69OfK6dXUWL3/XZxr2ftgkDKKzcILmuV6c96M8oIvZ+3udeH128tV9qtwn9HWA/pIJBn/PXGFTHt13ryU/01Dzysy7gYBMFV7UnR9+HXvz0Rw/4zHXN/2oaI/BgVx9zaBUX02rS39pCMywAAA2xJREFUs5q1CwJJR7WavvyqBP9TwxPTfv1iSw1SF+kgkCcYeSLy+3El/XHlyVMp7rYCBfRmEMyG7vLdjlwReXo8l2YdHT8VEXdUHHNrFwT2jN8zO2LY72qL/y1hDaSDQI7w9ruIGL9lRnK04+UjLsAaxqPvImIeZ2LuybEpIt9HRbMA1y6Yz//U8ESMV3+s+sBduyCQNJmo8yIzbBjN5269YWR6G0gHAQCR0DkzOyLGxfsVn7hrFwRS/F41WqXUnM8Go/VSbfd8tbfLKOnXx24AAGAX+P1o4XNyScp2CwJJoXNWtVwR0x7M53xxf6OdzRKxIaSDAKC68LoebSLYdoOVnrdrFwRSJn0K42KQ7VREq4mNiwExtj28LAYK5SwZKVhiAmxGzsqPgpUimyo43W7dtAfBaind2gWBpPC6rkVjf7krrvx+FGbvGXveJtJBIEe0gji7ZKRwiQlwT9FC4OzKj8KVIvcuKCIifk8zu2JcDFJ7v5WwdkEgKR5gbrkFfYrJptOuVU2eZBdt6N41OR9xU0gHgTz687aIuDdfU4/YeIM31k5iC/TnLRHxbr6l+iDhtxtPxHj5rDjm1i4YL9XMfT23xNoFgaSx8zbKBVkg8thIB4Fc0Y7TnqXP+p2TJW9sc4CtiDaO9hrVRMz1qw1PpP0mkXWF13VN0+qJI7zWLuj/0ynTvVm7ILBY1GnJ2VNmplK7DHJEZ9nFxyQyVWEDWEoC5Kucvrf/9iy3Y2rJ8zHZ5gBbc1R7f3HjNbxMzCWfdtEQtXh/fw1PJ29p1ywYjn6IiGfpmpXTGsP2oxMa1y4ILHH70xORubidYn3SQ2J0EChSqV0GbivxQeHsFmAzKqdX8bBHrJ2Jucqzl4Zk3gKvVTBaa7K8UesWBBaL+hXYCb/c3d2JyHA4PDk5eezGYH38BbGbiEwoiLDHDloclowOAgAAKI10EAAAQGmkgwAAAEojHQQAAFAa6SAAAIDSSAcBAACURjoIAACgNNJBAAAApZEOAgAAKI10EAAAQGmkgwAAAEojHQQAAFAa6SAAAIDSSAcBAACURjoIAACgtF/u7u5EZDgcPnZLAAAAsC0nJydFX8XpIAAAANTEy2IAAAClkQ4CAAAojXQQAABAaaSDAAAASiMdBAAAUBrpIAAAgNJIBwEAAJT2/wB7cwgzmONttQAAAABJRU5ErkJggg==" width="858" height="253" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip add 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-LoopBack0]ip add 10.0.1.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/0]ip add 10.0.12.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int l 0[R2-LoopBack0]ip add 10.0.2.2 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用ripv1搭建网络">使用RIPV1搭建网络<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E4%BD%BF%E7%94%A8ripv1%E6%90%AD%E5%BB%BA%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="使用RIPV1搭建网络的直接链接" title="使用RIPV1搭建网络的直接链接">​</a></h3>
<p>在公司两台路由器R1和R2 上配置RIP v1。</p>
<p>使用rip 命令创建并开启协议进程，默认情况下进程号是1。</p>
<p>使用network命令对指定网段接口使能RIP功能，注意必须是自然网段的地址。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]rip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-rip-1]network 10.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]rip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-rip-1]network 10.0.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，使用display ip routing-table 命令查看R1、R2 的路由表</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-6502cd2bb3b00931bea06a8ce724122d.webp" width="1080" height="641" class="img_ev3q"></p>
<p>可以观察到，两台路由器已经通过RIP协议学习到了对方环回接口所在网段的路由条目。</p>
<p>测试R1与R2环回接口间的连通性。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-efe7c157982344b8b00bb1d22890a0e2.webp" width="1080" height="416" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用ripv2搭建网络">使用RIPV2搭建网络<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#%E4%BD%BF%E7%94%A8ripv2%E6%90%AD%E5%BB%BA%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="使用RIPV2搭建网络的直接链接" title="使用RIPV2搭建网络的直接链接">​</a></h3>
<p>基于前面的配置，现在只需在RIP子视图模式下配置v2即可。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]rip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-rip-1]version 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]rip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-rip-1]version 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后使用display ip routing-table 命令查看各路由器路由表。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/4-5bd2ccbf7017e8a8102c0bcf2e39e8fb.webp" width="1080" height="641" class="img_ev3q"></p>
<p>可以观察到，两台路由器已经通过RIP协议学习到了对方环回接口所在网段的路由条目。</p>
<p>配置完成后，使用ping命令检测R1与R2之间直连链路的IP连通。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/5-8c2ee48659fb9e8ade1843e62e20105d.webp" width="1080" height="421" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">END<a href="https://ddn.org.cn/hcia/jklzzbnfg65e#end" class="hash-link" aria-label="END的直接链接" title="END的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="RIP" term="RIP"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[浮动静态路由及负载均衡]]></title>
        <id>https://ddn.org.cn/hcia/shgvjkjwwrehtu7</id>
        <link href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7"/>
        <updated>2024-04-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="浮动路由与静态路由">浮动路由与静态路由<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E6%B5%AE%E5%8A%A8%E8%B7%AF%E7%94%B1%E4%B8%8E%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1" class="hash-link" aria-label="浮动路由与静态路由的直接链接" title="浮动路由与静态路由的直接链接">​</a></h3>
<p>浮动静态路由(Floating Static Route)是一种特殊的静态路由，通过配置去往相同的目的网段，但优先级不同的静态路由，以保证在网络中优先级较高的路由，即主路由失效的情况下，提供备份路由。正常情况下，备份路由不会出现在路由表中。</p>
<p>负载均衡(Load sharing)，当数据有多条可选路径前往同一目的网络，可以通过配置相同优先级和开销的静态路由实现负载均衡，使得数据的传输均衡地分配到多条路径上，从而实现数据分流、减轻单条路径负载过重的效果。</p>
<p>而当其中某一条路径失效时，其他路径仍然能够正常传输数据，也起到了冗余作用。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解浮动静态路由的应用场景</li>
<li>掌握配置浮动静态路由的方法</li>
<li>掌握测试浮动静态路由的方法</li>
<li>掌握配置静态路由负载均衡的方法</li>
<li>掌握测试静态路由负载均衡的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>R2为某公司总部，R1与R3是两个分部，主机PC-1与PC-2所在的网段分别模拟两个分部中的办公网络。现需要总部与各个分部、分部与分部之间都能够通信。</p>
<p>且分部之间在通信时，之间的直连链路为主用链路，通过总部的链路为备用链路。本实验使用浮动静态路由实现需求，并再根据实际需求实现负载均衡来优化网络。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1-8f07a7db3c4a4761fc2f73a289ff864c.webp" width="752" height="546" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/table-d5a0e8c4430d7ff168365cba387156d1.png" width="861" height="486" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip add 192.168.10.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int s1/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-Serial1/0/1]ip add 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int s1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-Serial1/0/1]ip add 10.0.13.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int s1/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-Serial1/0/1]ip add 10.0.12.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int s1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-Serial1/0/1]ip add 10.0.23.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-GigabitEthernet0/0/0]ip add 192.168.20.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]int s1/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-Serial1/0/1]ip add 10.0.23.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]int s1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-Serial1/0/1]ip add 10.0.13.3 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现分部总部与分部部之间的通信">实现分部、总部与分部部之间的通信<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%EF%BF%BD%EF%BF%BD%E5%AE%9E%E7%8E%B0%E5%88%86%E9%83%A8%E6%80%BB%E9%83%A8%E4%B8%8E%E5%88%86%E9%83%A8%E9%83%A8%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1" class="hash-link" aria-label="实现分部、总部与分部部之间的通信的直接链接" title="实现分部、总部与分部部之间的通信的直接链接">​</a></h4>
<p>在R1上配置目的网段为主机PC-2所在网段的静态路由，在R3上配置目的网段为主机PC-1所在网段的静态路由，在R2上配置目的网段分别为主机PC-1和PC-2所在网段的静态路由。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]ip route-static 192.168.20.0 24 10.0.13.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]ip route-static 192.168.20.0 24 10.0.23.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]ip route-static 192.168.10.0 24 10.0.12.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]ip route-static 192.168.10.0 24 10.0.13.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在R1上查看路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-6066a9b1a18101a0e37d66ca7d9b11e4.webp" width="1080" height="599" class="img_ev3q"></p>
<p>可以观察到，在R1的路由表中存在以主机PC-2所在网段为目的网段的路由条目，且下一跳路由器为R3。测试主机PC-1与主机PC-2之间的连通性。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-e34e9ba40108498715a8b2a2fd7777c4.webp" width="745" height="288" class="img_ev3q"></p>
<p>通信正常，这时可以通过在主机PC-1上使用tracert命令测试所经过的网关。</p>
<p><img loading="lazy" src="data:image/webp;base64,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" width="745" height="167" class="img_ev3q"></p>
<p>通过观察发现数据包是经过R1和R3到达主机PC-2的。</p>
<p>同样在主机PC-2和R3上进行查看，首先在R3上查看路由表。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/5-06b5bf84ce78dcd77765d03c1ac6f255.webp" width="1080" height="595" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/6-fd72af66942f9b2b1eb95ce13a3e913a.webp" width="745" height="452" class="img_ev3q"></p>
<p>可以观察到通信正常。在主机PC-2上测试访问主机PC-1所经过的网关。</p>
<p><img loading="lazy" src="data:image/webp;base64,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" width="745" height="170" class="img_ev3q"></p>
<p>可以验证数据包是经过R3和R1到达主机PC-1的。</p>
<p>在总部路由器R2上测试与分部的连通性。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/8-eeb39733256b3d1fe42616b59ad69e49.webp" width="902" height="366" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/9-e23c04a27c7e96e8fa2d2c0b50bb8090.webp" width="1080" height="346" class="img_ev3q"></p>
<p>通过测试，总部路由器R2能够正常访问两个分部主机PC-1和主机PC-2的网络。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置浮动静态路由实现路由备份">配置浮动静态路由实现路由备份<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E9%85%8D%E7%BD%AE%E6%B5%AE%E5%8A%A8%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E8%B7%AF%E7%94%B1%E5%A4%87%E4%BB%BD" class="hash-link" aria-label="配置浮动静态路由实现路由备份的直接链接" title="配置浮动静态路由实现路由备份的直接链接">​</a></h4>
<p>通过上一步骤的配置，现在网络搭建已经初步完成。现需要实现当两分部间通信时，直连链路为主用链路，通过总部的链路为备用链路，即当主用链路发生故障时，可以使用备用链路保障两分部网络间的通信。这里使用浮动静态路由实现网络冗余。</p>
<p>在R1上配置静态路由，目的网段为主机PC-2所在网段，掩码为24位，下一跳为R2，将路由优先级设置为100(默认是60)中</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]ip route-static 192.168.20.0 24 10.0.12.2 preference 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看路由器R1的路由表。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/10-291dffe7c8f612a91c8fcd49bf4f7b41.webp" width="1065" height="595" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/11-c7d7f28d072ca6c2684985f76e04f4be.webp" width="1080" height="481" class="img_ev3q"></p>
<p>可以观察到目的地址为PC-2所在网段的两条优先级为100和60的静态路由条目都已经存在。</p>
<p>现在 R1 上去往相同的目的网段存在有两条不同路由条目，首先会比较它们的优先级，优先级高的，即对应的优先级数值较小的路由条目将被选为主用路由。通过比较，优先级数值为60的条目优先级更高，将被R1使用，放入路由表中，状态为Active;而另一条路由状态则为 Inactive，作为备份，不会被放入路由表。只有当Active 的路由条目失效时，优先级为100的路由条目才会被放入路由表。</p>
<p>在R3上做和R1同样的对称配置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R3]ip route-static 192.168.10.0 24 10.0.23.2 preference 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来，将路由器R1的S 1/0/1接口关闭，验证使用备份链路。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface serial 1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-Serial1/0/1]shutdown</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看路由器R1的路由表，并使用displayiprouting-table protocol static命令查看。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/12-b18f2f1e88cb7c4cd6978fd6188b07ec.webp" width="1080" height="502" class="img_ev3q"></p>
<p>可以观察到，此时优先级为100的路由条目已经添加到路由表中。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/13-1218467362e074ac6ae34af4eaf5a7ad.webp" width="1080" height="475" class="img_ev3q"></p>
<p>可以观察到，现在优先级为100的条目为Active状态，优先级为60的条目为Inactiye状态。</p>
<p>测试主机PC-1与PC-2间的通信。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/14-21dcce663df1f9985aba93bb7992a9f4.webp" width="745" height="289" class="img_ev3q"></p>
<p>通信正常，再使用tacert命令查看此时PC-1与PC-2通信时所经过的网关。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/15-35ab02c27d41162d0e13588646d2a047.webp" width="745" height="187" class="img_ev3q"></p>
<p>再次验证了此时两分部之间通信时已经使用了备用链路。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="通过负载均衡实现网络优化">通过负载均衡实现网络优化<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#%E9%80%9A%E8%BF%87%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96" class="hash-link" aria-label="通过负载均衡实现网络优化的直接链接" title="通过负载均衡实现网络优化的直接链接">​</a></h4>
<p>公司网络管理员发现分部之间业务往来越来越多，网络流量剧增，主用链路压力非常大，而总部与两分部间的网络流量相对较少，即备用链路上的带宽多处在闲置状态。此时可以通过配置实现负载均衡，即同时利用主备两条链路来支撑两分部间的通信。</p>
<p>恢复R1 上的S 1/0/1 接口，并配置目的网段为主机PC-2所在网段掩码为24 位，下一跳为R2，优先级不变。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface serial 1/0/1[R1-Serial1/0/1]undo shutdown[R1-Serial1/0/1]ip route-static 192.168.20.0 24 10.0.12.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用display ip routing-table 命令查看R1 上的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/16-32f40c258ca2f46d3dc5dbfb5cfdca84.webp" width="1080" height="612" class="img_ev3q"></p>
<p>配置完成后，可以观察到现在去往 192.168.20.0网段拥有两条下-跳不同的路由条目，即实现了负载均衡。测试主机PC-1与PC-2间的通信。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/17-cebf6f93d1498890a3e7ae5a82a6be10.webp" width="745" height="291" class="img_ev3q"></p>
<p>可以观察到，通信正常。</p>
<p>在R3上做和R1同样的对称配置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R3]ip route-static 192.168.10.0 24 10.0.23.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，能够在R3的路由表中观察到与R1路由表相同的情况。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/18-97afd9c0b0bc5b52115a7545e3d29c71.webp" width="1080" height="613" class="img_ev3q"></p>
<p>通过配置针对相同目的地址但优先级值不同的静态路由，可以在路由器上实现路径备份的功能。而通过配置针对相同目的地址且优先级值相同的静态路由，不仅互为备份还能实现负载均衡。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">END<a href="https://ddn.org.cn/hcia/shgvjkjwwrehtu7#end" class="hash-link" aria-label="END的直接链接" title="END的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="浮动路由" term="浮动路由"/>
        <category label="负载均衡" term="负载均衡"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[理解OSPF router-id]]></title>
        <id>https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw</id>
        <link href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw"/>
        <updated>2024-04-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p><strong>router-id</strong></p>
<p>一些动态路由协议要求使用 Router-ID 作为路由器的身份标示，如果在启动这些路由协议时没有指定Router-ID，则默认使用路由器全局下的路由管理Router-ID。</p>
<p>Router-ID 选举规则为，如果通过Router-ID命令配置了Router-ID，则按照配置结果设置。在没有配置Router-ID的情况下，如果存在配置了IP地址的Loopback接口，则选择Loopback接口地址中最大的地址作为 Router-ID;如果没有已配置IP 地址的Loopback接口，则从其他接口的IP地址中选择最大的地址作为Router-ID(不考虑接口的Up/Down状态)</p>
<p>当且仅当被选为Router-ID的接口IP地址被删除/修改，才触发重新选择过程，其他情况(例如接口处于DOWN状态;已经选取了一个非Loopback接口地址后又配置了一个Loopback接口地址;配置了一个更大的接口地址等)不触发重新选择的过程。</p>
<p>Router-ID 改变之后，各协议需要通过手工执行reset命令才会重新选取新的Router-ID。</p>
<p>路由器ID可以有以下几种方式确定：</p>
<ol>
<li>手动配置：管理员可以手动配置路由器ID，通常使用IPv4地址作为路由器ID。在OSPF配置中，可以使用命令 "router-id x.x.x.x" 来指定路由器ID。</li>
<li>默认方式：如果没有手动配置路由器ID，OSPF会自动选择一个路由器ID。通常，路由器ID会根据以下顺序选择：最高的回环接口IP地址，如果没有回环接口，则选择最高的物理接口IP地址。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解Router-ID 的选举规则</li>
<li>掌握OSPF 手动配置Router-ID的方法</li>
<li>理解OSPF 中Router-ID 必须唯一的意义</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络环境。</p>
<p>R1为部门A的网关设备，R3为部门B的网关设备，R4为部门C的网关设备，R2为企业核心路由器。</p>
<p>现网络中运行OSPF协议实现全网互通，所有路由器运行在区域0内，网络管理员需要正确配置 Router-ID 以避免产生不必要的问题。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/1.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/table.png" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="验证router-id">验证router-id<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E9%AA%8C%E8%AF%81router-id" class="hash-link" aria-label="验证router-id的直接链接" title="验证router-id的直接链接">​</a></h3>
<p>在进行基本配置之前，在 R1上使用 display route id 命令来查看当前设备上的Router-ID。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display Router ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Router-ID:0.0.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以观察到，在设备没有配置任何接口时，Router-ID为0.0.0.0。</p>
<p>根据实验编址表，在R1的GE 0/0/1接口上配置IP地址10.0.12.1，GE 0/0/0 接口配置IP地址10.0.1.254，配置环回接口0的地址1.1.1.1。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]ip addres 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip addres 10.0.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]int l0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-LoopBack0]ip addres1.1.1.1 32</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在R1上查看所有接口信息</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/2.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，目前所配置的接口及IP地址信息。查看当前设备上的Router-ID。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display Router ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Router-ID:10.0.12.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以观察到当前设备上的全局Router-ID为10.0.12.1，而不是环回接口地址1.1.1.1，这是为什么?</p>
<p>原因是接口配置顺序会影响 Router-ID 的选举，因为设备上第一次配置的是物理接口的地址，该动作便会触发Router-D的选举。而此刻，设备上也有且仅有该物理地址，所以该地址便会被 Router-ID 所使用，后续即使再配置了环回接口地址也不会使用。同理，如果第一次配置的是其他物理接口的地址，或者是环回接口的地址，都会被Router-ID所使用。</p>
<p>在R1上删除接口GE 0/0/1的IP地址，并再次查看此时设备的Router-ID。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface gigabitethernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]undo ip address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]display Router-ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Router-ID:1.1.1.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以观察到，当删除当前Router-ID所使用的IP地址时，便会触发重新选举，按照环回接口优先的规则选择使用1.1.1.1作为Router-ID。</p>
<p>采用手动配置的方式强制指定R1的Router-ID为1.1.1.1。</p>
<p>这样配置的优点是，即使该地址现在已经不是R1的任何接口的地址，也可以修改成为Router-ID(删除该环回接口也不会触发重新选举，验证省略)。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]Router-ID 1.1.1.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，马上会弹出以下信息:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Info: Router-ID has been modified, please reset the relative protocols</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">manually to update the Router-ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该信息表示 Router-ID 已经被修改，请重启相应的路由协议进行更新。</p>
<p>即当前全局配置的Router-ID已经被更新，如果目前设备上已经运行了OSPF协议，需要重置OSPF协议进程或者重启整台路由器才可以使得OSPF协议中的Router-ID也同步更新使用该新的全局Router-ID。</p>
<p>需要使用reset ospf process 命令来重置OSPF 协议进程。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p>根据实验编址表进行相应的基本配置，并使用ping命令检测各直连链路的连通性。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/0]ip add 10.0.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1]ip add 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-LoopBack0]ip add 1.1.1.1 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/0]ip add 10.0.12.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/1]ip add 10.0.23.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-GigabitEthernet0/0/2]ip add 10.0.24.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-LoopBack0]ip add 2.2.2.2 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-GigabitEthernet0/0/0]ip add 10.0.23.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-GigabitEthernet0/0/1]ip add 10.0.2.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-LoopBack0]ip add 3.3.3.3 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4-GigabitEthernet0/0/0]ip add 10.0.24.4 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4-GigabitEthernet0/0/1]ip add 10.0.3.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4-LoopBack0]ip add 4.4.4.4 32</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="理解ospf的ruoter-id">理解OSPF的ruoter-id<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#%E7%90%86%E8%A7%A3ospf%E7%9A%84ruoter-id" class="hash-link" aria-label="理解OSPF的ruoter-id的直接链接" title="理解OSPF的ruoter-id的直接链接">​</a></h3>
<p>在所有路由器上配置OSPF 协议，并都运行在区域0内。使用ospf router-id 命令来配置OSPF协议的私有Router-ID，如果不配置，则默认使用全局下的Router-ID。</p>
<p>注意区分设备全局下的Router-ID和路由协议的Router-ID的概念。如果在路由协议中没有配置 Router-ID，就会默认使用路由器的全局Router-ID。如果配置，则可以和全局Router-ID不一致。</p>
<p>一般建议采用环回接口地址作为路由协议的Router-ID，因为环回接口是逻辑接口，比物理接口更加稳定。在对网络操作时，网络管理员有可能误操作导致物理接口地址删除，或者改动，而环回接口则一般不会去改动。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]ospf 1 router-id 1.1.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-ospf-1-area-0.0.0.0]network 10.0.12.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-ospf-1-area-0.0.0.0]network 10.0.1.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2]ospf 1 router-id 2.2.2.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-ospf-1-area-0.0.0.0]network 10.0.12.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-ospf-1-area-0.0.0.0]network 10.0.23.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R2-ospf-1-area-0.0.0.0]network 10.0.24.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3]ospf 1 router-id 3.3.3.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-ospf-1-area-0.0.0.0]network 10.0.23.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R3-ospf-1-area-0.0.0.0]network 10.0.2.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4]ospf 1 router-id 4.4.4.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4-ospf-1-area-0.0.0.0]network 10.0.24.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R4-ospf-1-area-0.0.0.0]network 10.0.3.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后测试PC-1和PC-2间的连通性。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/3.webp" alt="" class="img_ev3q"></p>
<p>现在修改R2的Router-ID为3.3.3.3，即R3的Router-ID，使R3和R2的Router-ID重叠，并重置协议进程使该配置生效。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R2&gt;ospf 1 router-id 3.3.3.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R2&gt;reset ospf process</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/4.webp" alt="" class="img_ev3q"></p>
<p>可以观察到到R2与R3的邻居关系消失。</p>
<p>此时测试PC-1与PC-2的连通性。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/5.webp" alt="" class="img_ev3q"></p>
<p>网络已经发生故障，无法正常通信。验证了OSPF建立直连邻居关系时，Router-ID一定不能重叠。那么如果OSPF非直连邻居的Router-ID重叠会产生什么现象?</p>
<p>还原R2之前的配置，调整R4的Router-ID为3.3.3.3，与R3重叠。网络已经发生故障，无法正常通信。验证了OSPF建立直连邻居关系时，Router-ID一定不能重叠。那么如果OSPF非直连邻居的Router-ID重叠会产生什么现象?</p>
<p>还原R2之前的配置，调整R4的Router-ID为3.3.3.3，与R3重叠。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R2&gt;ospf 1 router-id 2.2.2.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R2&gt;reset ospf process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R4&gt;ospf 1 router-id 3.3.3.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R4&gt;reset ospf process</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R2的OSPF邻居状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R2&gt;display ospf peer brief</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/6.webp" alt="" class="img_ev3q"></p>
<p>发现R2有两个3.3.3.3的邻居，查看R2的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;R2&gt;display ip routing-table protocol ospf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/7.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，此时R2没有接收到R3上10.0.2.0/24网段的路由条目即使路由器邻居关系建立正常，但也无法正常获取路由条目。测试PC-1与PC-2间的连通性。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024415/8.webp" alt="" class="img_ev3q"></p>
<p>通信无法正常进行。这是因为R2认为是同一个OSPF邻居，但是LSA又不一致，造成链路状态数据库发送错误，无法计算出正确的路由信息。</p>
<p>综上所述，OSPF协议的Router-ID务必要在整个路由选择域内保持唯一。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">END<a href="https://ddn.org.cn/hcia/hu2gmp0suxo2y6rw#end" class="hash-link" aria-label="END的直接链接" title="END的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="OSPF" term="OSPF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[OSPF被动接口配置]]></title>
        <id>https://ddn.org.cn/hcia/tc9berlqph998yhg</id>
        <link href="https://ddn.org.cn/hcia/tc9berlqph998yhg"/>
        <updated>2024-04-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ospf被动接口">OSPF被动接口<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#ospf%E8%A2%AB%E5%8A%A8%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="OSPF被动接口的直接链接" title="OSPF被动接口的直接链接">​</a></h3>
<p>OSPF 被动接口的主要作用是减少网络中的 OSPF 消息洪泛，提高网络的性能和稳定性。具体来说，OSPF 被动接口的作用有以下几点：</p>
<ol>
<li>节省带宽：OSPF 被动接口不发送任何 OSPF 消息，只接收其他路由器发送的 OSPF 消息。这样可以避免在被动接口上发送大量的 OSPF 更新，节省了带宽资源。</li>
<li>减少 CPU 消耗：被动接口不需要处理和生成 OSPF 消息，因此可以减轻路由器的 CPU 负载，使其可以更好地处理其他重要的任务。</li>
<li>提高网络稳定性：通过减少洪泛的 OSPF 消息，可以减少网络中的拓扑变化通告，从而降低网络中的震荡和不稳定性。</li>
</ol>
<p>OSPF 被动接口也称抑制接口，成为被动接口后，将不会接收和发送 OSPF 报文。</p>
<p>其作用是优化网络性能、降低网络负载，并提高网络的稳定性和可靠性。</p>
<p>如果要使 OSPF 路由信息不被某一网络中的路由器获得且使本地路由器不接收网络中其他路由器发布的路由更新信息，即已运行在 OSPF 协议进程中的接口不与本链路上其余路由器建立邻居关系时，可通过配置被动接口来禁止此接口接收和发送 OSPF 报文。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目标">实验目标<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87" class="hash-link" aria-label="实验目标的直接链接" title="实验目标的直接链接">​</a></h3>
<ul>
<li>理解OSPF 被动接口的应用场景</li>
<li>掌握OSPF 被动接口的配置方法</li>
<li>理解OSPF 被动接口的作用原理</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络场景。有路由器R1、R2、R4与R5分属不同部门的网关设备，每台设备都连接着各部门的员工终端，公司整网运行OSPF协议，并都处于区域0中。</p>
<p>员工终端上经常收到路由器发送的OSPF数据报文，而该报文对终端而言毫无用处，还占用了一定的链路带宽资源，并有可能引起安全风险，比如非法接入路由器做路由欺骗。实现通告配置被动接口来实现阻隔OSPF报文，优化公司网络。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024409/1.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024409/table.png" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><strong>根据实验编址表进行相应的基本配置，并使用ping命令检测各直连链路的连通性。</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/0]ip add 10.0.3.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/1]ip add 10.0.13.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/0]ip add 10.0.23.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/1]ip add 10.0.4.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/0]ip add 10.0.13.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/1]ip add 10.0.23.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/2]ip add 10.0.30.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/0]ip add 10.0.30.4 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/1]ip add 10.0.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-GigabitEthernet0/0/0]ip add 10.0.30.5 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-GigabitEthernet0/0/1]ip add 10.0.2.254 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>测试联通性</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024409/2.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="搭建ospf网络">搭建OSPF网络<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E6%90%AD%E5%BB%BAospf%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="搭建OSPF网络的直接链接" title="搭建OSPF网络的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 10.0.13.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 10.0.3.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 10.0.4.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 10.0.23.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 10.0.13.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 10.0.23.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 10.0.30.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1-area-0.0.0.0]network 10.0.30.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1-area-0.0.0.0]network 10.0.1.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1-area-0.0.0.0]network 10.0.30.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1-area-0.0.0.0]network 10.0.2.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024409/3.webp" alt="" class="img_ev3q"></p>
<p>通信正常建立。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置�被动端口">配置被动端口<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E9%85%8D%E7%BD%AE%E8%A2%AB%E5%8A%A8%E7%AB%AF%E5%8F%A3" class="hash-link" aria-label="配置被动端口的直接链接" title="配置被动端口的直接链接">​</a></h3>
<p>现在网络管理员通过配置被动接口来优化连接终端的网络，使终端不再收到任何OSPF报文。</p>
<p>在r4的OSPF进程中，使用silent-interface命令禁止接口接收和发送OSPF报文。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r4]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]silent-interface GigabitEthernet 0/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果r4 上有多个接口需要设置为被动接口，只有GE 0/0/1接口保持活动状态，可以通过以下命令简化配置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]silent-interface all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]undo silent-interface GigabitEthernet 0/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这两种方法都可以将GE 0/0/1 接口设置为被动接口，区别在于第一种方法只是单独对某一个接口进行被动操作;</p>
<p>而第二种是在对所有接口配置为被动接口后，再排除不需要配置为被动接口的接口。</p>
<p>同样在其他部门的网关路由器上进行相应配置，使得所有部门的终端都不再收到无关的OSPF报文。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-0spf-1]silent-interface GigabitEthernet 0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]silent-interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1]silent-interface GigabitEthernet 0/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="验证被动端口">验证被动端口<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#%E9%AA%8C%E8%AF%81%E8%A2%AB%E5%8A%A8%E7%AB%AF%E5%8F%A3" class="hash-link" aria-label="验证被动端口的直接链接" title="验证被动端口的直接链接">​</a></h3>
<p>配置被动接口，该接口会禁止接收和发送OSPF报文，故假使在两台路由器间OSPF链路的接口上也做该配置，会导致OSPF邻居的无法建立。</p>
<p>以r5 为例，将其GE 0/0/0 接口配置为被动接口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r5]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1]silent-interface GigabitEthernet 0/0/0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R5的OSPF邻居关系状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;r5&gt;display ospf peer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以观察到，此时r5的OSPF邻居全部消失。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024409/4.webp" alt="" class="img_ev3q"></p>
<p>查看r5上的OSPF路由条目。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;r5&gt;display ip routing-table protocol ospf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以观察到，所有的 OSPF 路由条目都丢失。</p>
<p>即验证了配置了被动接口后，OSPF报文不再转发，包括建立邻居和维护邻居的Hello报文。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">END.<a href="https://ddn.org.cn/hcia/tc9berlqph998yhg#end" class="hash-link" aria-label="END.的直接链接" title="END.的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="OSPF" term="OSPF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[配置OSPF认证]]></title>
        <id>https://ddn.org.cn/hcia/pvmh27ucn2aw6265</id>
        <link href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265"/>
        <updated>2024-04-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p><strong>OSPF协议认证</strong></p>
<p>OSPF（Open Shortest Path First）协议支持基于认证的安全机制，用于确保 OSPF 消息的完整性和可信性。OSPF 认证可以防止未经授权的路由器加入 OSPF 域或篡改 OSPF 消息，提高网络的安全性。下面是 OSPF 认证的几个关键点：</p>
<p>认证类型：OSPF 支持明文认证和加密认证两种类型。</p>
<p>明文认证：在明文认证中，可以使用简单密码或密钥来进行认证。当路由器之间交换 OSPF 消息时，会使用明文密码进行验证。</p>
<p>加密认证：加密认证使用密钥对 OSPF 消息进行加密和解密。这样可以更好地保护认证信息的安全性。</p>
<p>认证域（Authentication Domain）：认证域是指在 OSPF 域中应用认证的范围。认证域可以是整个自治系统（AS）或特定的区域（Area）。</p>
<p>认证密钥：认证密钥是用于进行认证的密码或密钥。每个 OSPF 路由器在进行认证时需要使用相同的密钥。</p>
<p>认证配置：在 OSPF 配置中，需要指定认证类型和认证密钥。认证配置可以应用于整个自治系统或特定的区域。</p>
<p>需要注意的是，为了使 OSPF 认证生效，所有参与 OSPF 的路由器都必须配置相同的认证类型和密钥。如果认证配置不一致，可能会导致路由器无法建立邻居关系或交换 OSPF 消息。</p>
<p>OSPF 认证提供了一定程度的网络安全，但并不是完全安全的。为了确保网络的安全性，还应考虑其他安全机制，如访问控制列表（ACL）、身份认证协议等。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解OSPF 认证的应用场景</li>
<li>理解OSPF 区域认证和链路认证的区别</li>
<li>掌握配置OSPF 区域认证的方法</li>
<li>掌握配置OSPF 链路认证的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络环境。R3、R5、R6属于公司总部骨干区域路由器，R2为ABR。公司分部路由器R1和R4都属于区域1，但分属不通部门，R1作为市场部门网关，R4作为财务部门网关。网络管理员在区域0和区域1上配置OSPF区域认证，其中区域0开启密文认证，区域1开启明文认证。为进一步提高该OSPF网络安全性，R2和R4上单独设置密钥，配置OSPF链路认证。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/1.webp" alt="" class="img_ev3q"></p>
<a name="Db3Oa"></a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" alt="table" src="https://ddn.org.cn/assets/images/table-228fe1352a5d7104766c03ab751f810c.png" width="314" height="697" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/0]ip add 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-LoopBack0]ip add 1.1.1.1 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/0]ip add 10.0.12.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/1]ip add 10.0.24.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/1]ip add 10.0.23.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-LoopBack0]ip add 2.2.2.2 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/0]ip add 10.0.35.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/1]ip add 10.0.36.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/2]ip add 10.0.23.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-LoopBack0]ip add 3.3.3.3 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/0]ip add 10.0.24.4 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-LoopBack0]ip add 4.4.4.4 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-GigabitEthernet0/0/0]ip add 10.0.35.5 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-LoopBack0]ip add 5.5.5.5 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-GigabitEthernet0/0/0]ip add 10.0.36.6 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6]int l 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-LoopBack0]ip add 6.6.6.6 32</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置ospf网络"><strong>配置OSPF网络</strong><a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E9%85%8D%E7%BD%AEospf%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="配置ospf网络的直接链接" title="配置ospf网络的直�接链接">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置公司分部ospf区域明文认证"><strong>配置公司分部OSPF区域明文认证</strong><a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E9%85%8D%E7%BD%AE%E5%85%AC%E5%8F%B8%E5%88%86%E9%83%A8ospf%E5%8C%BA%E5%9F%9F%E6%98%8E%E6%96%87%E8%AE%A4%E8%AF%81" class="hash-link" aria-label="配置公司分部ospf区域明文认证的直接链接" title="配置公司分部ospf区域明文认证的直接链接">​</a></h3>
<p>网络管理员在公司分部的OSPF区域1中配置区域明文认证。在R1上OSPF的区域1视图下使用authentication-mode命令指定该区域使用认证模式为simple，即简单验证模式，配置口令为huawei1，并配置plain参数。</p>
<p>配置 plain 参数后，可以使得在查看配置文件时，口令均以明文方式显示。如果不设置该参数的话，在查看配置文件时，默认会以密文方式显示口令，即无法查看到所配置的口令原文，这可以使非管理员用户在登录设备后无法查看到口令原文，从而提高安全性</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0,1]authentication-mode simple huawei1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成，等待OSPF网络收敛之后，查看R1与R2的OSPF邻居。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/2.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，现在R1与R2邻居关系中断了，原因是目前仅仅在R1上配置了认证，导致R1和R2间的OSPF认证不匹配。继续配置该区域的另一台设备R2，必须要保证验证模式一致，口令也一致。配置完成后，等待一段时间，再次观察两者的邻居关系。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]area 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-0spf-1-area-0.0.0.1]authentication-mode simple huawei1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/3.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，现在R1与R2的邻居关系状态恢复正常。</p>
<p>同理在R4上也做相同配置。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r4]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]area 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-0spf-1-area-0.0.0.1]authentication-mode simple huawei1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在R2上查看OSPF邻居关系。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/4.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，现在区域1中的邻居关系都建立正常。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置公司总部ospf区域密文认证"><strong>配置公司总部OSPF区域密文认证</strong><a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E9%85%8D%E7%BD%AE%E5%85%AC%E5%8F%B8%E6%80%BB%E9%83%A8ospf%E5%8C%BA%E5%9F%9F%E5%AF%86%E6%96%87%E8%AE%A4%E8%AF%81" class="hash-link" aria-label="配置公司总部ospf区域密文认证的直接链接" title="配置公司总部ospf区域密文认证的直接链接">​</a></h3>
<p>根据设计，网络管理员在公司总部OSPF区域0中配置区域密文认证。</p>
<p>在R2上配置OSPF Area0区域认证，使用验证模式为md5，即MD5 验证模式，验证字标识符为1，配置口令为huawei3。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]authentication-mode md5 1 huawei3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>继续在其他骨干路由器上做相同配置。注意，密文认证必须保证验证字标识符和口令完全一致认证才可以通过。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]authentication-mode md5 1 huawei3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1-area-0.0.0.0]authentication-mode md5 1 huawei3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-ospf-1-area-0.0.0.0]authentication-mode md5 1 huawei3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/5.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，OSPF邻居状态建立正常，其他设备上的查看过程省略</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置ospf链路认证"><strong>配置OSPF链路认证</strong><a href="https://ddn.org.cn/hcia/pvmh27ucn2aw6265#%E9%85%8D%E7%BD%AEospf%E9%93%BE%E8%B7%AF%E8%AE%A4%E8%AF%81" class="hash-link" aria-label="配置ospf链路认证的直接链接" title="配置ospf链路认证的直接链接">​</a></h3>
<p>在上面两个步骤中，使用了OSPF的区域认证方式配置了OSPF认证，使用链路认证方式配置可以达到同样的效果。如果采用链路认证的方式，就需要在同一0SPF的链路接口下都配置链路认证的命令，设置验证模式和口令等参数;而采用区域认证的方式时，在同一区域中，仅需在OSPF进程下的相应区域视图下配置一条命令来设置验证模式和口令即可，大大节省了配置量，所以在同一区域中如果有多台OSPF设备需要配置认证，建议选用区域认证的方式进行配置。</p>
<p>目前公司分部的 OSPF 区域中配置了简单模式的区域认证，为了进一步提升 R2 与R4 之间的 OSPF 网络安全性，网络管理员需要在两台设备之间部署 MD5 验证模式的OSPF链路认证。</p>
<p>在R2的GE 0/0/1 接口下使用ospf authentication-mode 命令配置链路认证，配置使用MD5验证模式，验证字标识符为1，口令为huawei5。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/1]ospf authentication-mode md5 1 huawei5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/6.webp" alt="" class="img_ev3q"></p>
<p>发现R2与R4间的OSPF邻居关系已经消失。虽然已经配置好区域认证，但是如果同时配置了接口认证和区域认证时，会优先使用接口验证建立 OSPF 邻居。所以 R4在没有配置链路认证之前，R2与R4的邻居关系会因认证不匹配而无法建立。</p>
<p>同样在R4上配置链路，注意，验证模式、标识符、口令都需要保持一致。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r4]interface GigabitEthernet 0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/1]ospf authentication-mode md5 1 huawei5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，等待一段时间，再次查看R4的OSPF邻居信息。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024403/7.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，邻居关系已经恢复正常。至此，OSPF链路认证配置完成。</p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="OSPF" term="OSPF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[OSPF单区域的配置]]></title>
        <id>https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3</id>
        <link href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3"/>
        <updated>2024-03-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍:]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍:<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍:的直接链接" title="实验介绍:的直接链接">​</a></h2>
<p>关于本实验的所需要的知识点补充</p>
<p><strong>OSPF</strong></p>
<p>OSPF 作为基于链路状态的协议，具有收敛快、路由无环、扩展性好等优点，被快速接受并广泛使用。</p>
<p>链路状态算法路由协议互相通告的是链路状态信息，每台路由器都将自己的链路状态信息(包含接口的 IP 地址和子网掩码、网络类型、该链路的开销等）发送给其他路由器，并在网络中泛洪，当每台路由器收集到网络内所有链路状态信息后，就能拥有整个网络的拓扑情况，然后根据整网拓扑情况运行 SPF 算法，得出所有网段的最短路径。</p>
<p>OSPF 作为基于链路状态的协议，具有收敛快、路由无环、扩展性好等优点，被快速接受并广泛使用。链路状态算法路由协议互相通告的是链路状态信息，每台路由器都将自己的链路状态信息(包含接口的 IP 地址和子网掩码、网络类型、该链路的开销等）发送给其他路由器，并在网络中泛洪，当每台路由器收集到网络内所有链路状态信息后，就能拥有整个网络的拓扑情况，然后根据整网拓扑情况运行 SPF 算法，得出所有网段的最短路径。</p>
<p>OSPF 协议可以帮助这些路由器建立最佳的路径选择，以实现数据报文的传输。下面是 OSPF 的一些详细原理和功能：</p>
<ol>
<li>链路状态数据库（Link State Database）：每个 OSPF 路由器都会维护一个链路状态数据库，其中存储了网络中所有路由器的链路状态信息。这些信息包括邻居关系、链路带宽、延迟、可达性等。</li>
<li>链路状态通告（Link State Advertisement）：OSPF 路由器通过使用特定的消息格式，将自己的链路状态信息广播给相邻的路由器。这些消息包含了该路由器对网络的拓扑图的描述。</li>
<li>SPF 计算（Shortest Path First）：每个 OSPF 路由器使用链路状态数据库中的信息来计算到达其他网络的最短路径。它使用 Dijkstra 算法，考虑链路带宽、延迟等参数来确定最佳路径。计算完成后，每个路由器都会拥有一张路由表，描述了到达各个网络的最佳路径。</li>
<li>路由器交互与邻居关系建立：OSPF 路由器之间通过交换 Hello 消息来建立邻居关系。这些邻居关系的建立是必要的，因为只有与邻居路由器建立了连接，才能交换链路状态信息进行路由计算。</li>
<li>路由更新与拓扑变化通知：OSPF 路由器会周期性地向邻居路由器发送链路状态更新信息，以通知其他路由器网络拓扑的变化。当有链路发生故障或网络拓扑发生变化时，路由器会立即发送通知，以便其他路由器更新他们的路由表。</li>
</ol>
<p>综上所述，OSPF 通过收集和交换链路状态信息，计算最短路径，并建立和维护邻居关系，实现了动态路由的功能。它能够适应网络的变化，优化数据包的传输路径，提高网络性能和可靠性。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>掌握OSPF 单区域的配置方法</li>
<li>理解OSPF 单区域的应用场景</li>
<li>掌握查看OSPF 邻居状态的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络场景。</p>
<p>该公司有三大办公区，每个办公区放置了一台路由器，R1放在办公区A，A区经理的PC-1直接连接R1;</p>
<p>R2放在办公区B，B区经理的PC-2直接连接到R2;</p>
<p>R3放在办公区C，C区经理的 PC-3直接连接到R3;</p>
<p>3台路由器都互相直连,为了能使整个公司网络互相通信，需要在所有路由器上部署路由协议。</p>
<p>考虑到公司未来的发展（部门的增加和分公司的成立)，为了适应不断扩展的网络的需求，公司在所有路由器上部署OSPF协议，且现在所有路由器都属于骨干区域。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/1.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/table-a76628cdeff4d858d0bf2f3dd2c54600.png" width="959" height="678" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/2.webp" alt="" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/3.webp" alt="" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/4.webp" alt="" class="img_ev3q"></p>
<p>根据实验编址表进行相应的基本配置，并使用ping命令检测各直连链路的连通性。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/0]ip add 172.16.10.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/1]ip add 172.16.20.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/2]ip add 172.16.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/0]ip add 172.16.10.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/1]ip add 172.16.30.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/2]ip add 172.16.2.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/0]ip add 172.16.20.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/1]ip add 172.16.30.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/2]ip add 172.16.3.254 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置单区域ospf网络">配置单区域OSPF网络<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E9%85%8D%E7%BD%AE%E5%8D%95%E5%8C%BA%E5%9F%9Fospf%E7%BD%91%E7%BB%9C" class="hash-link" aria-label="配��置单区域OSPF网络的直接链接" title="配置单区域OSPF网络的直接链接">​</a></h3>
<p>1代表的是进程号，如果没有写明进程号，则默认是1。</p>
<p>接着使用area命令创建区域并进入OSPF区域视图，输入要创建的区域ID。由于本实验为OSPF单区域配置，所以使用骨干区域，即区域0即可。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 172.16.10.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 172.16.20.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 172.16.1.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 172.16.10.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 172.16.30.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 172.16.2.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 172.16.20.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 172.16.30.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 172.16.3.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后使用display ospf interface命令检查OSPF接口通告是否正确。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display ospf interface</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/5.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="检查ospf单区域的配置结果">检查OSPF单区域的配置结果<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#%E6%A3%80%E6%9F%A5ospf%E5%8D%95%E5%8C%BA%E5%9F%9F%E7%9A%84%E9%85%8D%E7%BD%AE%E7%BB%93%E6%9E%9C" class="hash-link" aria-label="检查OSPF单区域的配置结果的直接链接" title="检查OSPF单区域的配置结果的直接链接">​</a></h3>
<p>以R1为例使用display ospf peer 命令查看OSPF 邻居状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display ospf peer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/6.webp" alt="" class="img_ev3q"></p>
<p>通过这条命令，可以查看很多内容。例如，通过Router-ID可以查看邻居的路由器标识;通过Address可以查看邻居的OSPF接口IP地址;通过State可以查看目前与该路由器的OSPF邻居状态﹔通过Priority可以查看当前该邻居OSPF接口的DR优先级等。</p>
<p>使用display ip routing-table protocol ospf命令查看R1上的OSPF 路由表。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/7.webp" alt="" class="img_ev3q"></p>
<p>通过此路由表可以观察到，“Destination/Mask”标识了目的网段的前缀及掩码，“Proto”标识了此路由信息是通过 OSPF 协议获取的“Pre”标识了路由优先级，“Cost”标识了开销值，“NextHop”标识了下一跳地址，“Interface”标识了此前缀的出接口。</p>
<p>此时 R1的路由表中已经拥有了去往网络中所有其他网段的路由条用同样方法查看R2与R3的OSPF邻居状态。</p>
<p>再次测试主机PC-1与PC-2和PC-3间的通信。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024326/8.webp" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">End<a href="https://ddn.org.cn/hcia/zkl0b6ktakqxq9r3#end" class="hash-link" aria-label="End的直接链接" title="End的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="OSPF" term="OSPF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[OSPF多区域的配置]]></title>
        <id>https://ddn.org.cn/hcia/oshwut8eb7a94y4s</id>
        <link href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s"/>
        <updated>2024-03-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p>关于本实验的所需要的知识点补充</p>
<p><strong>原理概述</strong></p>
<p>在 OSPF（Open Shortest Path First）协议中，多区域（Multi-Area）是一种将整个自治系统（AS）划分为多个逻辑区域（Area）的设计概念。</p>
<p>在 OSPF 网络中，一个自治系统可以被划分为多个区域。每个区域内的路由器会维护一个独立的链路状态数据库，只存储与本区域相关的链路状态信息。</p>
<p>而区域之间的路由器仅存储与其他区域之间的连接信息，而不存储其他区域内的链路状态信息。<br>OSPF 多区域的设计带来了以下几个好处：</p>
<ol>
<li>
<p>减少链路状态数据库的规模：OSPF 的链路状态数据库是存储网络中所有路由器的链路状态信息，当网络规模较大时，链路状态数据库的大小可能会很大。通过划分为多个区域，可以将链路状态数据库分散到各个区域中，减小每个路由器的链路状态数据库的规模，降低存储和计算的负担。</p>
</li>
<li>
<p>减少链路状态通告的范围：在多区域的 OSPF 网络中，每个区域只需通告本区域的链路状态信息给其他区域的路由器，减少了链路状态通告的范围和数量。这样可以减少链路状态通告的网络流量和处理开销。</p>
</li>
<li>
<p>控制网络更新范围：区域划分可以帮助网络管理员更好地控制网络的拓扑更新。当一个区域发生拓扑变化时，只需通告给其他相关的区域，而不需要通告给整个自治系统，减少了网络更新的范围和影响。</p>
</li>
<li>
<p>提高网络的可扩展性和性能：通过将自治系统划分为多个区域，可以更好地控制链路状态数据库大小、减少链路状态通告范围、降低网络更新的开销，从而提高网络的可扩展性和性能。</p>
</li>
</ol>
<p>需要注意的是，OSPF 多区域设计需要合理划分区域边界和设计区域之间的连接，同时需要配置区域之间的路由器进行区域间路由的交换与转发。正确的区域规划可以提高 OSPF 网络的可管理性、可扩展性和性能。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解配置OSPF 多区域的使用场景</li>
<li>掌握配置OSPF 多区域的方法</li>
<li>理解OSPF 区域边界路由器(ABR)的工作特点</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络场景。R1、R2、R3、R4 为企业总部核心区域设备，属于区域 0，R5 属于新增分支机构 A 的网关设备，R6 属于新增分支机构 B 的网关设备。</p>
<p>PC-1 和 PC-2 分别属于分支机构 A 和 B，PC-3 和 PC-4 属于总部管理员登录设备，用于管理网络。在该网络中，如果设计方案采用单区域配置，则会导致单一区域 LSA 数目过于庞大，导致路由器开销过高，SPF 算法运算过于频繁。</p>
<p>因此网络管理员选择配置多区域方案进行网络配置，将两个新分支运行在不同的 OSPF 区域中，其中 R5 属于区域 1，R6 属于区域 2。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1-d1d0111001a3c6f8085c50474c4dd2b3.webp" width="937" height="634" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编制">实验编制<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%88%B6" class="hash-link" aria-label="实验编制的直接链接" title="实验编制的直接链接">​</a></h3>
<p><img loading="lazy" alt="image-20240327093713560" src="https://ddn.org.cn/assets/images/table-2c85066c336705b50e56c962fbcffbff.png" width="482" height="641" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-2f7480985b3512f26acbf9ae5747830c.webp" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-b0690f4524fc244f3c58f5bf857943db.webp" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/4-f348b96a8c90469fa35527c6ca6f80f4.webp" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/5-2ebd78c0b7b348ed821afe73a71df12d.webp" width="781" height="533" class="img_ev3q"></p>
<p>根据实验编址表进行相应的基本配置，并使用ping命令检测各直连链路的连通性。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/0]ip add 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/1]ip add 10.0.13.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/2]ip add 10.0.15.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/0]ip add 10.0.12.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/1]ip add 10.0.24.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-GigabitEthernet0/0/2]ip add 10.0.26.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/0]ip add 10.0.34.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/1]ip add 10.0.13.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/2]ip add 10.0.35.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int e4/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-Ethernet4/0/0]ip add 10.0.3.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/0]ip add 10.0.34.4 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/1]ip add 10.0.24.4 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-GigabitEthernet0/0/2]ip add 10.0.46.4 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int e4/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-Ethernet4/0/0]ip add 10.0.4.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-GigabitEthernet0/0/0]ip add 10.0.15.5 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-GigabitEthernet0/0/1]ip add 10.0.35.5 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-GigabitEthernet0/0/2]ip add 10.0.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-GigabitEthernet0/0/0]ip add 10.0.26.6 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6]int g0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-GigabitEthernet0/0/1]ip add 10.0.46.6 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6]int g0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-GigabitEthernet0/0/2]ip add 10.0.2.254 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置骨干区域路由器">配置骨干区域路由器<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E9%85%8D%E7%BD%AE%E9%AA%A8%E5%B9%B2%E5%8C%BA%E5%9F%9F%E8%B7%AF%E7%94%B1%E5%99%A8" class="hash-link" aria-label="配置骨干区域路由器的直接链接" title="�配置骨干区域路由器的直接链接">​</a></h3>
<p>在公司总部路由器R1、R2、R3、R4上创建OSPF进程，并在骨干区域0视图下通告总部各网段。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 10.0.12.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.0]network 10.0.13.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 10.0.12.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.0]network 10.0.24.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 10.0.13.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 10.0.34.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.0]network 10.0.3.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]area 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1-area-0.0.0.0]network 10.0.34.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1-area-0.0.0.0]network 10.0.24.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1-area-0.0.0.0]network 10.0.4.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，测试总部内两台PC间的连通性</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/6-cb664ac38e80e40cd9aa2ad9a52fc2f8.webp" width="781" height="533" class="img_ev3q"></p>
<p>已经可以正常通信，骨干区域路由器配置完成。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置非骨干区域路由器">配置非骨干区域路由器<a href="https://ddn.org.cn/hcia/oshwut8eb7a94y4s#%E9%85%8D%E7%BD%AE%E9%9D%9E%E9%AA%A8%E5%B9%B2%E5%8C%BA%E5%9F%9F%E8%B7%AF%E7%94%B1%E5%99%A8" class="hash-link" aria-label="配置非骨干区域路由器的直接链接" title="配置非骨干区域路由器的直接链接">​</a></h3>
<p>在分支A的路由器R5上创建OSPF进程，创建并进入区域1，并通告分支A的相应网段。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r5]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1]area 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1-area-0.0.0.1]network 10.0.15.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1-area-0.0.0.1]network 10.0.35.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r5-ospf-1-area-0.0.0.1]network 10.0.1.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在R1和R3上也创建并进入区域1视图，将与R5相连的接口进行通告。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1]area 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-ospf-1-area-0.0.0.1]network 10.0.15.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1]area 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-ospf-1-area-0.0.0.1]network 10.0.35.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看OSPF邻居状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display ospf peer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/7-d1d9b2d5e7647f22811821e835d6dc5b.webp" width="937" height="498" class="img_ev3q"></p>
<p>可以观察到，现在R5与R1和R3的OSPF邻居关系建立正常，都为Full状态。<br>使用display ip routing-table protocol ospf命令查看R5路由表中的OSPF路由条目。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display ip routing-table protocol ospf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/8-104b3736b6c8f6b299ea714f9616bdc8.webp" width="937" height="521" class="img_ev3q"></p>
<p>可以观察到，除OSPF区域2内的路由外，相关OSPF路由条目都已经获得。在拓扑中，R1和R3这两台连接不同区域的路由器称为ABR，即区域边界路由器，该类路由器设备可以同时属于两个以上的区域但其中至少一个端口必须在骨干区域内。</p>
<p>ABR是用来连接骨干区域和非骨干区域的，其与骨干区域之间既可以是物理连接，也可以是逻辑上的连接。<br>使用display ospf lsdb命令查看R5 的OSPF 链路状态数据库信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display ospf lsdb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/9-c98decb064574d4401178f9222385074.webp" width="937" height="542" class="img_ev3q"></p>
<p>可以观察到，关于其他区域的路由条目都是通过“Sum-Net”这类.SA获得，而这类LSA是不参与本区域的SPF算法运算的。</p>
<p>对公司另一分部B的路由器R6，和相应ABR设备R2、R4也做同样的配置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r6]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-ospf-1]area 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-ospf-1-area-0.0.0.2]network 10.0.26.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-ospf-1-area-0.0.0.2]network 10.0.46.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r6-ospf-1-area-0.0.0.2]network 10.0.2.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1]area 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-ospf-1-area-0.0.0.2]network 10.0.26.0 0.0.0.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4]ospf 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1]area 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r4-ospf-1-area-0.0.0.2]network 10.0.46.0 0.0.0.255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成，查看R6的OSPF 路由条目。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/10-4a9eff061e0b7e0abcf1ba1ad9befedf.webp" width="937" height="510" class="img_ev3q"></p>
<p>观察到可以正常接收到所有OSPF路由信息。<br>测试分支A和分支B的PC-1和PC-2连通性。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/11-16ae4cf0adb9a27a6e5480303f4a1a59.webp" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/12-112f4b47a69c9af2e0d5010b28bf14dd.webp" width="781" height="533" class="img_ev3q"></p>
<p>可以观察到，现在通信正常。至此，OSPF多区域配置完成。</p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="OSPF" term="OSPF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[静态路由和默认路由的配置（remake）]]></title>
        <id>https://ddn.org.cn/hcia/staicrouter</id>
        <link href="https://ddn.org.cn/hcia/staicrouter"/>
        <updated>2024-02-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p><strong>静态路由和默认路由</strong></p>
<p>静态路由和默认路由都是路由协议的一种，它们在计算机网络中用于决定数据包的传输路径。</p>
<p>静态路由是由网络管理员手动配置的路由规则，它不会改变。静态路由会告诉路由器如何将数据包从一个网络转发到另一个网络。</p>
<p>默认路由是一种特殊的静态路由，它指定了一个路由器作为默认路由，即当数据包没有指定目标网络时，路由器将使用默认路由来转发数据包。默认路由有助于优化路由器的性能和网络带宽的使用，因为它可以将数据包发送到最合适的目标网络，而不需要经过更多的路由查找过程。</p>
<p>因此，静态路由和默认路由在计算机网络中通常一起使用，以实现更高效的数据包转发和网络连接。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>掌握配置静态路由(指定下一跳IP 地址)的方法</li>
<li>掌握配置静态路由(指定接口)的方法</li>
<li>掌握测试静态路由连通性的方法</li>
<li>掌握配置默认路由的方法</li>
<li>掌握测试默认路由的方法</li>
<li>掌握在简单网络中部署静态路由时的故障排除方法</li>
<li>掌握简单的网络优化方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>在由3台路由器所组成的简单网络中，R1与R3各自连接着一台主机，现在要求能够实现主机PC-1与PC-2之间的正常通信。本实验将通过配</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/1.webp" alt="1.webp" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1709865465328-b75243656b747766bce3051be4e293d8.png" width="870" height="481" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/staicrouter#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/2.webp" alt="2.webp" class="img_ev3q"></p>
<p>根据实验编址表进行相应的基本配置，并使用ping命令检测各直连链路的连通性。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-GigabitEthernet0/0/0]ip add 192.168.10.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]int s 1/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1-Serial1/0/0]ip add 10.0.12.1 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int s1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-Serial1/0/1]ip add 10.0.12.2 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2]int s1/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r2-Serial1/0/0]ip add 10.0.23.2 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int s1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-Serial1/0/1]ip add 10.0.23.3 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]int g0/0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3-GigabitEthernet0/0/0]ip add 192.168.20.3 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/3.webp" alt="3.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/4.webp" alt="4.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/5.webp" alt="5.webp" class="img_ev3q"></p>
<p>各直连链路间的IP连通性测试完成后，现尝试在主机PC-1上直接ping主机PC-2。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/6.webp" alt="6.webp" class="img_ev3q"></p>
<p>发现无法连通，这时需要思考是什么问题导致了它们之间无法通信。</p>
<p>首先假设主机PC-1与PC-2之间如果能够正常连通，那么主机A将发送数据给其网关设备R1;R1收到后将根据数据包中的目的地址查看它的路由表，找到相应的目的网络的所在路由条目，并根据该条目中的下一跳和出接口信息将该数据转发给下一台路由器R2;R2采取同样的步骤将数据转发给R3;最后R3也采取同样的步骤将数据转发给与自己直连的主机PC-2;主机PC-2在收到数据后，与主机PC-1发送数据到PC-2的过程一样，再发送相应的回应消息给PC-1。</p>
<p>在保证基本配置没有错误的情况下，首先查看主机PC-1与其网关设备R1间能否正常通信。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/7.webp" alt="7.webp" class="img_ev3q"></p>
<p>主机与网关之间通信正常，接下来检查网关设备R1上的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;r1&gt;display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/8.webp" alt="8.webp" class="img_ev3q"></p>
<p>可以看到在R1的路由表上，没有任何关于主机PC-2所在网段的信息。可以使用同样的方式查看R2与R3的路由表</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/9.webp" alt="9.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/10.webp" alt="10.webp" class="img_ev3q"></p>
<p>可以看到在R2上没有任何关于主机PC-1和PC-2所在网段的信息，R3上没有任何关于主机PC-1所在网段的信息，验证了初始情况下各路由器的路由表上仅包括了与自身直接相连的网段的路由信息。</p>
<p>现在主机PC-1与PC-2之间跨越了若干个不同网段，要实现它们之间的通信，只通过简单的IP地址等基本配置是无法实现的，必须在3台路由器上添加相应的路由信息,可以通过配置静态路由来实现。</p>
<p>配置静态路由有两种方式，一种是在配置中采取指定下一跳IP地址的方式，另一种是指定出接口的方式。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置静态路由实现主机pc-1与pc-2之间的通信">配置静态路由(实现主机PC-1与PC-2之间的通信)<a href="https://ddn.org.cn/hcia/staicrouter#%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E4%B8%BB%E6%9C%BApc-1%E4%B8%8Epc-2%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1" class="hash-link" aria-label="配置静态路由(实现主机PC-1与PC-2之间的通信)的直接链接" title="配置静态路由(实现主机PC-1与PC-2之间的通信)的直接链接">​</a></h3>
<p>在 R1 上配置目的网段为主机 PC-2所在网段的静态路由，即目的IP 地址为192.168.20.0，掩码为255.255.255.0。</p>
<p>对于R1而言，要发送数据到主机PC-2，则必须先发送给R2，所以R2即为R1的下一跳路由器，R2与R1所在的直连链路上的物理接口的IP地址即为下一跳IP地址，即10.0.12.2.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ip route-static 192.168.20.0 24 10.0.12.2 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R1上的路由表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;r1&gt;display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复��制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/11.webp" alt="11.webp" class="img_ev3q"></p>
<p>配置完成后，可以在R1的路由表上查看到主机PC-2所在网段的路由信息。</p>
<p>采取同样的方式在R2上配置目的网段为主机PC-2所在网段的静态路由。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ip route-static 192.168.20.0 24 10.0.23.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;r2&gt;display ip routing-table</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/12.webp" alt="12.webp" class="img_ev3q"></p>
<p>在R3上配置目的网段为PC-1所在网段的静态路由，即目的IP地址为192.168.10.0，目的地址的掩码除了可以采用点分十进制的格式表示外，还可以直接使用掩码长度，即24来表示。</p>
<p>对于R3而言，要发送数据到PC-1，则必须先发送给R2，所以R3与R2所在直连链路上的物理接口S 0/0/1即为数据转发接口，也称为出接口，在配置中指定该接口即可。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ip route-static 192.168.10.0 24 Serial 1/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>采取同样的方式在R2上配置目的网段为PC-1所在网段的静态路由。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r2]ip route-static 192.168.10.0 24 Serial 1/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R1、R2、R3上的路由表。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/13.webp" alt="13.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/14.webp" alt="14.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/15.webp" alt="15.webp" class="img_ev3q"></p>
<p>可以看到，现在每台路由器上都拥有了主机PC-1与PC-2所在网段的路由信息。</p>
<p>再在主机PC-1上ping主机PC-2。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/16.webp" alt="16.webp" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实现全网全通来增强网络的可靠性">实现全网全通来增强网络的可靠性<a href="https://ddn.org.cn/hcia/staicrouter#%E5%AE%9E%E7%8E%B0%E5%85%A8%E7%BD%91%E5%85%A8%E9%80%9A%E6%9D%A5%E5%A2%9E%E5%BC%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E5%8F%AF%E9%9D%A0%E6%80%A7" class="hash-link" aria-label="实现全网全通来增强网络的可靠性的直接链接" title="实现全网全通来增强网络的可靠性的直接链接">​</a></h3>
<p>经过上面的步骤，主机PC-1与PC-2之间已经能够正常通信。</p>
<p>假设此时网络突然出现故障，主机PC-1侧的网络管理员发现无法与PC-2正常通信，于是先测试与网关设备R1间的连通性。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/17.webp" alt="17.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/18.webp" alt="18.webp" class="img_ev3q"></p>
<p>发现无法与R3正常通信，这也意味着此时网络管理员将无法通过主机PC-1登录到R3上进一步排除故障，由此可见，保证全网的连通性能够增强整网的可靠性，提高网络的可维护性及健壮性。</p>
<p>发现无法与R3正常通信，这也意味着此时网络管理员将无法通过主机PC-1登录到R3上进一步排除故障，由此可见，保证全网的连通性能够增强整网的可靠性，提高网络的可维护性及健壮性。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ip route-static  10.0.23.0 24 10.0.12.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ip route-static 10.0.12.0 24 Serial 1/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R1、R2、R3的路由表，注意观察新增的条目。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/19.webp" alt="19.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/20.webp" alt="20.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/21.webp" alt="21.webp" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/22.webp" alt="22.webp" class="img_ev3q"></p>
<p>测试成功，主机PC-1可以顺利与R3通信，同样主机PC-2此时也能够与R1进行通信，测试过程这里省略。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用默认路由实现简单的网络优化">使用默认路由实现简单的网络优化<a href="https://ddn.org.cn/hcia/staicrouter#%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96" class="hash-link" aria-label="使用默认路由实现简单的网络优化的直接链接" title="使用默认路由实现简单的网络优化的直接链接">​</a></h3>
<p>通过适当减少设备上的配置工作量，能够帮助网络管理员在进行故障排除时更轻松地定位故障，且相对较少的配置量也能减少在配置时出错的可能。</p>
<p>另一方面，也能够相对减少对设备本身硬件的负担。默认路由是一种特殊的静态路由，使用默认路由可以简化路由器上的配置。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/23.webp" alt="23.webp" class="img_ev3q"></p>
<p>此时 R1 上存在两条先前经过手动配置的静态路由条目，且它们的下一跳和出接口都一致。</p>
<p>现在在R1上配置一条默认路由，即目的网段和掩码为全0，表示任何网络，下一跳为10.0.12.2，并删除先前配置的两条静态路由。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r1]ip route-static 0.0.0.0 0 10.0.12.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]undo ip route-static 10.0.23.0 255.255.255.0 10.0.12.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r1]undo ip route-static 192.168.20.0 255.255.255.0 10.0.12.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看R1的路由表</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/24.webp" alt="24.webp" class="img_ev3q"></p>
<p>再测试主机PC-1与PC-2间的通信</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/25.webp" alt="25.webp" class="img_ev3q"></p>
<p>发现主机PC-1与PC-2间的通信正常，证明使用默认路由不但能够实现与静态路由同样的效果，而且还能够减少配置量。在R3上可以进行同样的配置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[r3]ip route-static 0.0.0.0 0 Serial 1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]undo ip route-static 10.0.12.0 255.255.255.0 Serial 1/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[r3]undo ip route-static 192.168.10.0 255.255.255.0 Serial 1/0/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/26.webp" alt="26.webp" class="img_ev3q"></p>
<p>再次测试主机PC-1与PC-2间的通信。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024229/27.webp" alt="27.webp" class="img_ev3q"></p>
<p>主机PC-1与PC-2间的通信正常。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">END.<a href="https://ddn.org.cn/hcia/staicrouter#end" class="hash-link" aria-label="END.的直接链接" title="END.的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="静态路由" term="静态路由"/>
        <category label="默认路由" term="默认路由"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[配置Eth-Trunk 链路聚合]]></title>
        <id>https://ddn.org.cn/hcia/eth-trunk</id>
        <link href="https://ddn.org.cn/hcia/eth-trunk"/>
        <updated>2024-02-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p>Eth-Trunk（以太网聚合）是一种将多个物理以太网链路（例如，Ethernet 接口）捆绑成一个逻辑链路的技术，以提高链路的带宽和冗余性。通过 Eth-Trunk，多个物理链路可以同时工作，形成一个高带宽的逻辑链路，提供更高的数据传输能力和可靠性。</p>
<p>Eth-Trunk 通过将数据流量在物理链路之间进行分发和负载均衡，以实现链路的聚合。它可以在交换机之间或交换机与服务器之间创建，通常使用一种聚合协议（如 LACP，即链路聚合控制协议）来实现链路的捆绑和管理。</p>
<p>通过 Eth-Trunk，可以实现以下功能：</p>
<ol>
<li>增加总带宽：将多个物理链路聚合成一个逻辑链路，增加了可用带宽，提高了数据传输能力。</li>
<li>负载均衡：在多个物理链路之间均衡分配数据流量，提高了网络的性能和效率。</li>
<li>冗余备份：当某个物理链路出现故障时，Eth-Trunk 可以自动切换到其他可用链路，提供冗余备份，提高网络的可靠性。</li>
</ol>
<p>需要注意的是，Eth-Trunk 的配置需要在网络设备（如交换机）上进行，具体的配置方法和命令可能因厂商和设备型号而有所不同。在配置 Eth-Trunk 之前，需要确保网络设备支持该功能，并按照设备的文档和指导进行操作。</p>
<p><strong>Eth-Trunk 链路聚合的配置模式</strong></p>
<ol>
<li>静态链路聚合：静态链路聚合是通过手动配置成员链路来创建 Eth-Trunk。管理员需要明确指定哪些物理链路被绑定到 Eth-Trunk 接口上。静态链路聚合不依赖于任何协议来管理链路的状态，因此它适用于不支持动态链路聚合协议的设备或环境。静态链路聚合的优点是配置简单，不需要额外的协议支持。但缺点是手动配置成员链路，不具备动态监测链路状态和自动恢复故障链路的能力。</li>
<li>动态链路聚合：动态链路聚合使用链路聚合控制协议（Link Aggregation Control Protocol，LACP）来管理 Eth-Trunk 接口的成员链路。LACP 协议允许设备自动检测可用链路，并与对端设备进行通信以协商和管理链路的状态。</li>
</ol>
<p>动态链路聚合的优点是具备自动检测链路状态、自动恢复故障链路以及动态负载均衡的能力。它能够根据链路的可用性和设备间的协商来动态调整链路的状态和带宽分配。</p>
<p>需要注意的是，具体支持的链路聚合模式可能因厂商和设备型号而有所不同。在进行链路聚合配置时，建议参考设备的文档和指南，或者联系设备厂商以获取更具体的配置信息。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解使用Eth-Trunk 的应用场景</li>
<li>掌握配置Eth-Trunk 链路聚合的方法(手工负载分担模式)</li>
<li>掌握配置Eth-Trunk 链路聚合的方法(静态LACP模式)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络环境。S1和S2为企业核心交换机，PC-1属于A部门终端设备，PC-2属于B部门终端设备。根据企业规划，S1和S2之间线路原由一条光纤线路相连，但出于带宽和冗余角度考虑需要对其进行升级，可使用Eth-Trunk实现此需求。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/1.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<table><thead><tr><th>设备</th><th>接口</th><th>地址</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>10.0.1.1/24</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>10.0.1.2/24</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/eth-trunk#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/2.webp" alt="" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/3.webp" alt="" class="img_ev3q"></p>
<p>其他主机间互相通信测试和上述相同</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置链路聚合手工负载分担模式">配置链路聚合（手工负载分担模式）<a href="https://ddn.org.cn/hcia/eth-trunk#%E9%85%8D%E7%BD%AE%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88%E6%89%8B%E5%B7%A5%E8%B4%9F%E8%BD%BD%E5%88%86%E6%8B%85%E6%A8%A1%E5%BC%8F" class="hash-link" aria-label="配置链路聚合（手工负载分担模式）的直接链接" title="配置链路聚合（手工负载分担模式）的直接链接">​</a></h3>
<p>在<code>S1</code>和<code>S2</code>上配置链路聚合，创建<code>Eth-Trunk 1</code>接口，并指定为手工负载分担模式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Sl]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Eth-Trunk1]mode manual load-balance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Eth-Trunk1]mode manual load-balance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将<code>S1</code>和<code>S2</code>的<code>GE /0/1</code> 和<code>GE 0/0/2</code> 分别加入到<code>Eth-Trunk 1</code>接口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]eth-trunk 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]eth-trunk 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，可以使用<code>display eth-trunk 1</code> 命令查看<code>S1</code>和<code>S2</code>的<code>Eth-Trunk</code>接口状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display eth-trunk 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/4.webp" alt="" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/5.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，<code>S1</code>与<code>S2</code>的工作模式为<code>NORMAL</code>(手工负载分担方式)，<code>GE0/0/1</code>与<code>GE0/0/2</code>接口已经添加到<code>Eth-Trunk1</code>中，并且处于<code>UP</code> 状态。</p>
<p>使用<code>display interface eth-trunk</code>命令查看<code>S2</code>的<code>Eth-Trunk1</code>接口信息</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display interface eth-trunk1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/6.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，目前该接口的总带宽是<code>GE 0/0/1</code>与<code>GE0/0/2</code> 接口带宽之和。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置链路聚合lacp模式">配置链路聚合（LACP模式）<a href="https://ddn.org.cn/hcia/eth-trunk#%E9%85%8D%E7%BD%AE%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88lacp%E6%A8%A1%E5%BC%8F" class="hash-link" aria-label="配置链路聚合（LACP模式）的直接链接" title="配置链路聚合（LACP模式）的直接链接">​</a></h3>
<p>在<code>S1</code>和<code>S2</code>上配置链路聚合，创建<code>Eth-Trunk 1</code>接口，并指定为静态<code>LACP</code>模式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Eth-Trunk1]mode  lacp-static </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Eth-Trunk1]mode  lacp-static </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>如果在此处出行报错，请将先前已经加入到Eth-Trunk接口下的物理接口删除。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet [id]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet[id]]undo eth-trunk [id]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>开启<code>S1</code>与<code>S2</code> 上的<code>GE 0/0/5</code> 接口模拟增加了一条新链路。将<code>S1</code>和<code>S2</code>的<code>GE /0/1</code> 和<code>GE 0/0/2</code> 和<code>GE0/0/5</code>分别加入到<code>Eth-Trunk 1</code>接口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]interface GigabitEthernet 0/0/5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/5]eth-trunk </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]interface GigabitEthernet 0/0/5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/5]eth-trunk 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，使用<code>display eth-trunk 1</code> 命令查看<code>S1</code>和<code>S2</code>的<code>Eth-Trunk 1</code>接口状态。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/7.webp" alt="" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/8.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，3个接口默认都处于活动状态(Selected)。</p>
<p>将<code>S1</code>的系统优先级从默认的<code>32768</code>改为<code>100</code>，使其成为主动端(值越低优先级越高)，并按照主动端设备的接口来选择活动接口。</p>
<p>两端设备选出主动端后，两端都会以主动端的接口优先级来选择活动接口。</p>
<p>两端设备选择了一致的活动接口，活动链路组便可以建立起来，设置这些活动链路以负载分担的方式转发数据。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]lacp priority 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看<code>S1</code>的<code>Eth-Trunk1</code>接口状态。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/9.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，已经将<code>S1</code>的<code>LACP</code>系统优先级改为<code>100</code>，而<code>S2</code>没修改:仍为默认值。</p>
<p>在<code>S1</code>上配置活动接口上限阈值为<code>2</code>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Eth-Trunk1]max active-linknumber 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在<code>S1</code>上配置接口的优先级确定活动链路。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]lacp priority 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]lacp priority 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置接口的活动优先级将默认的<code>32768</code> 改为<code>100</code>，目的是使<code>GE0/0/1</code>和<code>GE 0/0/2</code> 接口成为活动状态。</p>
<p>配置完成后，查看<code>S1</code>的<code>Eth-Trunk1</code>接口状态。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/10.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，由于将接口的阈值改为2(默认活动接口最大阈值为8)。</p>
<p>该Eth-Trunk接口下将只有两个成员处于活动状态，并且具有负载分担能力。</p>
<p>而GE0/0/5接口已处于不活动状态(Unselect)，该链路作为备份链路。</p>
<p>当活动链路出现故障时，备份链路将会替代故障链路，保持数据传输的可靠性。</p>
<p>将<code>S1</code>的<code>GE 0/0/1</code>接口关闭，验证Eth-Trunk链路聚合信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]shutdown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]display eth-trunk 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/11.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，S1的GE0/0/1接口已经处于不活动状态，而GE0/0/5 接口为活动状态。</p>
<p>如果将S1的 GE 0/0/1 接口开启后，又会恢复为活动状态，GE 0/0/5 则为不活动状态。</p>
<p>至此，完成了整个Eth-Trunk的部署。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">End.<a href="https://ddn.org.cn/hcia/eth-trunk#end" class="hash-link" aria-label="End.的直接链接" title="End.的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="Eth-Trunk" term="Eth-Trunk"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Smart Link与Monitor Link]]></title>
        <id>https://ddn.org.cn/hcia/smart-link-and-monitor-link</id>
        <link href="https://ddn.org.cn/hcia/smart-link-and-monitor-link"/>
        <updated>2024-02-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p><strong>Smart Link与Monitor Link</strong></p>
<p>Smart Link（智能链路）和 Monitor Link（监视链路）是网络中常见的两种链路冗余技术，用于提高网络的可靠性和冗余性。</p>
<ol>
<li>
<p>Smart Link（智能链路）：Smart Link 是一种链路冗余技术，通过在网络设备之间建立备用链路，以实现故障时的快速切换和恢复。在 Smart Link 中，设备会通过心跳包或链路状态检测来监测主链路的可用性。当主链路发生故障或不可用时，备用链路会立即接管数据流量，实现对网络服务的无感知切换，以确保网络的连通性和稳定性。</p>
</li>
<li>
<p>Monitor Link（监视链路）：Monitor Link 是一种链路监测技术，用于监视特定链路的状态和性能。它通常用于监测和收集链路的带宽利用率、延迟、丢包率等性能指标。通过监视链路，网络管理员可以及时了解链路的运行情况，并根据监测结果做出相应的优化和决策，以提高网络的性能和可靠性。</p>
</li>
</ol>
<p>需要注意的是，Smart Link 和 Monitor Link 是不同的概念，用途和实现方式也不同。Smart Link 主要用于链路冗余和故障切换，以提高网络的可靠性；而 Monitor Link 主要用于链路状态监测和性能监测，以优化网络的性能和运行状况。</p>
<p>总之，Smart Link 和 Monitor Link 是两种常见的网络链路技术，用于提高网络的可靠性和性能。Smart Link 实现链路冗余和快速故障切换，而 Monitor Link 实现链路状态和性能的监测。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解Smart Link 的应用场景</li>
<li>掌握Smant Link 组的基本配置</li>
<li>掌握Smart Link 回切功能的配置</li>
<li>掌握Monitor Link 的基本配置</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟公司网络场景。交换机S4作为公司出口设备连接外网:交换机S1是接入层交换机，负责员工终端接入，接入交换机通过两台交换机S2和S3双上行连接到S4。针对此双上行组网，为了实现主备链路冗余备份及故障后的快速迁移，部署使用 Smart Link 技术，且为了进一步扩展Smart Link 的备份范围，使用Monitor Link联动方式监控上游设备的上行链路来完善Smart Link。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/1.webp" alt="1" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置smart-link">配置Smart Link<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E9%85%8D%E7%BD%AEsmart-link" class="hash-link" aria-label="配置Smart Link的直接链接" title="配置Smart Link的直接链接">​</a></h3>
<p>公司接入层交换机S1通过S2和S3双上行链路连接到出口交换机S4,为了实现主备链路冗余备份及快速迁移，需要在S1上配置SmartLinke</p>
<p>在S1 上创建Smart Link 组1，并开启Smart Link 组功能。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]smart-link group 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-smlk-group1]smart-link enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置Smart Link 时，需要在相关运行Smart Link 的接口下关闭生成树协议。由于华为交换机默认开启了生成树协议，因此需要关闭S1交换机上E0/0/3 和E 0/0/4 接口下的生成树协议。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface Ethernet 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethemet0/0/3]stp disable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]interface Etheret 0/0/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/4]stp disable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注意，如果相应接口下生成树协议未关闭，在配置SmantLink 组功能时会报错，将会出现提示信息。</p>
<p>STP进入到Smart Link 组1下，配置E0/0/3 为主接口，E0/0/4为备份接口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]smart-link group 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-smlk-group1]port Ethemet 0/0/3 master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-smlk-group1]port Ethemet 0/0/4 slave</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，使用display smart-link group1命令查看主备状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]display smart-link group 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/2.webp" alt="2" class="img_ev3q"></p>
<p>可以观察到，S1交换机的E0/0/3为主接口，且状态为Active;E0/0/4 为备份接口，状态为Inactive。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置回切功能">配置回切功能<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E9%85%8D%E7%BD%AE%E5%9B%9E%E5%88%87%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="配置回切功能的直接链接" title="配置回切功能的直接链接">​</a></h3>
<p>当S1 上主接口E0/0/3 出现故障关闭时，备份接口会立刻切换为Active状态。并且默认情况下，当原主接口恢复时，主接口不会自动回切到Active状态，需要手工配置回切功能。</p>
<p>将S2 交换机E0/0/3 接口关闭，模拟故障发生，在S1上观察SmartLink 组1的主备状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface Ethernet 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]shutdown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]display smart-link group 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/3.webp" alt="3" class="img_ev3q"></p>
<p>可以观察到，接口的状态没有发生变化，E0/0/3 接口仍然处于Inactive 状态，并没有抢占原来的Active状态。即当主链路出现故障后会自动切换到备份链路;而当原主链路故障恢复后，为了保持网络稳定，它将维持在阻塞状态，不进行抢占。如果需要原主链路恢复为Active 状态，可以通过配置Smant Link 组回切功能，在回切定时器超时后会自动切换到主链路。</p>
<p>在S1 上使用restore enable 命令开启回切功能，并将回切时间设置为30s(默认为60s)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]smart-link group 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-smlk-group1]restore enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-smlk-group1]timer wtr 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>再次在S1上观察SmartLink 组1的主备状态。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/4.webp" alt="4" class="img_ev3q"></p>
<p>可以观察到，S1的E 0/0/3 接口状态又重新恢复到Active 状态，而E0/0/4 接口回到了Inactive状态。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置monitor-link">配置Monitor Link<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#%E9%85%8D%E7%BD%AEmonitor-link" class="hash-link" aria-label="配置Monitor Link的直接链接" title="配置Monitor Link的直接链接">​</a></h3>
<p>正常情况下，S1与S2之间的链路为主链路，但是当S2 的上行接口GE 0/0/1 故障时，Smart Link 无法感知故障，不会发生切换，导致网络中断。为了解决这一问题，需要在S2上配置Monitor Link 监控上行接口，当GE 0/0/1 故障时，使S1 的Smart Link 组切换。</p>
<p>为了模拟该场景，现将S2的GE O/0/1接口关闭，并查看Smart Link组1的主备状态</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]shutdown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]display smart-link group 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/5.webp" alt="5" class="img_ev3q"></p>
<p>可以观察到，当S2 的上行GE 0/0/1接口出现故障以后，连接到下行链路的S1 交换机无法感知到该故障，导致S1交换机的 Smart Link 无法进行切换，这样会导致连接到S1交换机仍然选择E0/0/3 接口转发数据，无法正常通信。</p>
<p>在S2 上启用Monitor Link 组1，配置上行接口为GE0/0/1，下行接口为E 0/0/3。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]monitor-link group 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mtlk-group1]port GigabitEthemet 0/0/1 uplink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mtlk-group1]port Ethernet 0/0/3 downlink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，再次查看S1的Smart Link组1的主备状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]display smart-link group 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/6.webp" alt="6" class="img_ev3q"></p>
<p>观察发现E 0/0/3 接口状态已经变为Inactive，E0/0/4接口状态成为了Active，流量已经被切换到E 0/0/4接口，保证了用户流量的正常转发。</p>
<p>修改Monitor Link组的回切时间为10秒(默认为3s)。当S2的上行接口GE 0/0/1重新恢复以后，下行链路SmartLink 组将在时间到期后重新回切到主链路。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mtlk-group1]timer recover-time 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>重新开启S2 的GE 0/0/1 接口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEtheret0/0/1]undo shutdown</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>等待40s 左右(加上步骤2中配置的Smart Link回切时间)，查看S1的Smart Link组1的主备状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]display smart-link group 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024221/7.webp" alt="7" class="img_ev3q"></p>
<p>可以观察到，此时S1的E0/0/3 接口重新恢复到了Active 状态。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">End.<a href="https://ddn.org.cn/hcia/smart-link-and-monitor-link#end" class="hash-link" aria-label="End.的直接链接" title="End.的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="Monitor Link" term="Monitor Link"/>
        <category label="Smart Link" term="Smart Link"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[GVRP基础配置]]></title>
        <id>https://ddn.org.cn/hcia/gvrp</id>
        <link href="https://ddn.org.cn/hcia/gvrp"/>
        <updated>2024-02-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/gvrp#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gvrp">GVRP<a href="https://ddn.org.cn/hcia/gvrp#gvrp" class="hash-link" aria-label="GVRP的直接链接" title="GVRP的直接链接">​</a></h3>
<p>GVRP（GARP VLAN Registration Protocol）是一种通信协议，用于在局域网（LAN）中自动注册和管理虚拟局域网（VLAN）的成员关系。</p>
<p>GVRP 是基于 IEEE 802.1Q VLAN 标准的一部分，旨在简化和自动化 VLAN 的配置和管理。它使用了 GARP（Generic Attribute Registration Protocol）作为底层协议，在网络中的交换机之间传输 VLAN 成员关系的信息。</p>
<p>通过 GVRP，交换机可以自动学习和维护 VLAN 成员关系。当设备（如计算机或网络设备）加入或离开特定的 VLAN 时，GVRP 会在网络中的交换机之间传递成员关系的更新信息，从而保持各交换机的 VLAN 成员表的一致性。</p>
<p><strong>GVRP 的主要功能包括：</strong></p>
<ol>
<li>VLAN 成员关系的自动学习和维护：当设备加入或离开 VLAN 时，GVRP 会自动更新交换机的 VLAN 成员表。</li>
<li>动态 VLAN 成员关系的传递：GVRP 会在网络中的交换机之间动态传递 VLAN 成员关系的更新信息，以保持各交换机的 VLAN 成员表的同步。</li>
<li>VLAN 成员关系的控制：GVRP 允许管理员通过配置交换机的 GVRP 参数来控制哪些 VLAN 的成员关系应该被传递和学习。</li>
</ol>
<p>需要注意的是，GVRP 只在支持 GVRP 协议的交换机之间进行通信，并且需要在交换机上进行相应的配置。</p>
<p>总之，GVRP 是一种用于自动注册和管理 VLAN 成员关系的协议，通过在交换机之间传递更新信息，保持各交换机的 VLAN 成员表的一致性。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gvrp的配置模式"><strong>GVRP的配置模式</strong><a href="https://ddn.org.cn/hcia/gvrp#gvrp%E7%9A%84%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%BC%8F" class="hash-link" aria-label="gvrp的配置模式的直接链接" title="gvrp的配置模式的直接链接">​</a></h3>
<p>手工配置的 VLAN 称为静态 VLAN，通过 GVRP 协议创建的VLAN 称为动态VLAN。GVRP有3种注册模式，不同的式对静态VLAN和动态VLAN的处理方式也不同。</p>
<p>Normal模式:允许该接口动态注册、注销VLAN，传播动态VLAN以及静态VLAN信息;</p>
<p>Fixed 模式:禁止该接口动态注册、注销VLAN，只传播静态VLAN 信息。即被设置成为该模式下的Trunk接口，即使允许所有VLAN通过，实际通过的VLAN也只能是手动配置的那部分;</p>
<p>Forbidden模式:禁止该接口动态注册、注销VLAN，不传播任何除VLAN1以外的任何VLAN信息。即被设置成为该模式下的Trunk接口，即使允许所有VLAN通过，实际通过的VLAN 也只能是VLAN 1。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/gvrp#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h2>
<ul>
<li>理解GVRP 的应用场景</li>
<li>掌握GVRP 的配置</li>
<li>理解GVRP 不同注册模式的区别</li>
<li>掌握GVRP 配置不同注册模式的方法</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/gvrp#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h2>
<p>本实验模拟企业网络场景。S1和S4是接入层交换机，分别连接到汇聚层交换机S2和 S3，公司不同部门员工通过接入层交换机连接到网络。现在需要在交换机上划分VLAN隔离不同部门，但考虑到部门较多，且随着发展，网络情况可能会越来越复杂，采用手工配置 VLAN的方式工作量会非常大，而且容易导致配置错误。此时可以通过GVRP的VLAN自动注册功能完成VLAN的配置。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/gvrp#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h2>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/1.webp" alt="1" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/gvrp#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h2>
<table><thead><tr><th>设备</th><th>接口</th><th>地址/掩码</th><th>所属vlan</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>10.1.1.1/24</td><td>VLAN10</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>10.1.1.2/24</td><td>VLAN20</td></tr><tr><td>PC3</td><td>E0/0/1</td><td>10.1.1.3/24</td><td>VLAN10</td></tr><tr><td>PC4</td><td>E0/0/1</td><td>10.1.1.4/24</td><td>VLAN20</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/gvrp#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/gvrp#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/2.webp" alt="2" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/3.webp" alt="3" class="img_ev3q"></p>
<p>其他主机间互相通信测试和上述相同。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置gvrp单向注册"><strong>配置GVRP单向注册</strong><a href="https://ddn.org.cn/hcia/gvrp#%E9%85%8D%E7%BD%AEgvrp%E5%8D%95%E5%90%91%E6%B3%A8%E5%86%8C" class="hash-link" aria-label="配置gvrp单向注册的直接链接" title="配置gvrp单向注册的直接链接">​</a></h3>
<p>在公司的二层网络中，有IT和HR两个不同的部门，需要将它们划分到不同的VLAN中去。如果按照常规配置方法，要手工在所有交换机上都创建相应的VLAN。后续如果有新的部门需要新增VLAN，或者层网络整改，都要随之修改VLAN配置，配置量非常大且易出错，现网络管理员采用GVRP来完成VLAN配置。</p>
<p>将4台交换机之间所互连的接口(连接PC的接口除外)的接口类型都配置为Trunk，并允许所有VLAN通过。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s1">S1<a href="https://ddn.org.cn/hcia/gvrp#s1" class="hash-link" aria-label="S1的直接链接" title="S1的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s2">S2<a href="https://ddn.org.cn/hcia/gvrp#s2" class="hash-link" aria-label="S2的直接链接" title="S2的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s3">S3<a href="https://ddn.org.cn/hcia/gvrp#s3" class="hash-link" aria-label="S3的直接链接" title="S3的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/1]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/2]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s4">S4<a href="https://ddn.org.cn/hcia/gvrp#s4" class="hash-link" aria-label="S4的直接链接" title="S4的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-GigabitEthernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-GigabitEthernet0/0/1]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S1 上创建VLAN 10和VLAN20，并把连接PC的接口类型配置为Access，划入到相应的VLAN中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Vlan10]vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Vlan20]interface Ethernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]interface Ethernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/2]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/2]port default vlan 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在所有交换机上都开启 GVRP 功能，并在所有交换机两两互连的接口下也开启GVRP功能。GVRP注册模式默认为Normal模式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s1]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/1]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/2]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S4]gvrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-GigabitEthernet0/0/1]gvrp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在S2、S3、S4 上使用display vlan命令查看所有VLAN的相关信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display vlan</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/4.webp" alt="4" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/5.webp" alt="5" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/6.webp" alt="6" class="img_ev3q"></p>
<p>可以观察到，S2、S3、S4都动态获得了VLAN 10和VLAN 20。但是在S2上只有GE 0/0/2 加入了这两个VLAN，同样在S3上只有GE 0/0/1加入这两个VLAN，在S4上只有GE 0/0/1加入了这两个VLAN。这是因为此时在S2、S3、S4 上只有左侧的端口收到GVRP的注册消息，此时只完成了单向注册。</p>
<p>由于PC-1 与PC-3 同属于I 部门，即VLAN 10 内，现验证它们之间的连通性。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/7.webp" alt="7" class="img_ev3q"></p>
<p>发现无法通信，再次验证了此时只完成了单向注册。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置gvrp双向注册">配置GVRP双向注册<a href="https://ddn.org.cn/hcia/gvrp#%E9%85%8D%E7%BD%AEgvrp%E5%8F%8C%E5%90%91%E6%B3%A8%E5%86%8C" class="hash-link" aria-label="配置GVRP双向注册的直接链接" title="配置GVRP双向注册的直接链接">​</a></h3>
<p>现需要在S4上也手工创建VLAN 10和VLAN20，把连接PC的接口的模式配置为Access，划入相应VLAN中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;S4&gt;system-view</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4]vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Vlan10]vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Vlan20]interface Ethernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Ethernet0/0/1]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Ethernet0/0/1]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Ethernet0/0/1]interface Ethernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Ethernet0/0/2]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Ethernet0/0/2]port default vlan 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在S2、S3 上再次使用display vlan命令查看。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/8.webp" alt="8" class="img_ev3q"></p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/9.webp" alt="9" class="img_ev3q"></p>
<p>可以观察到此时两台汇聚交换机的右侧接口也加入了VLAN 10 和VLAN 20。因为从右侧收到了S4的GVRP注册消息，此时完成了双向注册。</p>
<p>在PC-1上验证与PC-3之间的连通性</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/10.webp" alt="10" class="img_ev3q"></p>
<p>如果现在公司网络整改，需要添加新的汇聚交换机，或者替换新款设备，或者增删VLAN配置，都可以通过GVRP动态实现自动配置，不再需要手工配置。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置gvrp的fixed模式">配置GVRP的Fixed模式<a href="https://ddn.org.cn/hcia/gvrp#%E9%85%8D%E7%BD%AEgvrp%E7%9A%84fixed%E6%A8%A1%E5%BC%8F" class="hash-link" aria-label="配置GVRP的Fixed模式的直接链接" title="配置GVRP的Fixed模式的直接链接">​</a></h3>
<p>现在S3 的GE 0/0/1接口下将GVRP 的注册模式修改为Fixed 模式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S3]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/1]gvrp registration fixed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S3 上使用display vlan 命令查看。</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/11.webp" alt="11" class="img_ev3q"></p>
<p>发现在GE 0/0/1 接口已经无法动态学习到VLAN信息，这是由于Fixed 模式下不允许动态VLAN在接口上注册，相应同部门内跨交换机的两台PC就无法通信。</p>
<p>这时的解决办法有两种，一种是在S3上手工创建VLAN10 和VLAN20，另一种是恢复GE 0/0/1接口下GVRP 注册模式为Normal 模式，做相应配置即可。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置gvrp的forbidden模式">配置GVRP的Forbidden模式<a href="https://ddn.org.cn/hcia/gvrp#%E9%85%8D%E7%BD%AEgvrp%E7%9A%84forbidden%E6%A8%A1%E5%BC%8F" class="hash-link" aria-label="配置GVRP的Forbidden模式的直接链接" title="配置GVRP的Forbidden模式的直接链接">​</a></h3>
<p>在S2 的GE 0/0/1接口下将GVRP 的注册模式修改为Forbidden 模式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]gvrp registration forbidden</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S2 上使用display vlan 命令查看</p>
<p><img loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024220/12.webp" alt="12" class="img_ev3q"></p>
<p>可以观察到此时VLAN 10、VLAN20 中都没有GE 0/0/1 接口加入这是因为GE 0/0/1 接口下注册模式配置成了Forbidden 模式后，将只允许VLAN1通过。可以观察到，所有交换机上的 MST域名都为 huawei，修订版本号都为 1，且VLAN 与实例间的映射关系相同，其中除 VLAN 10 与20之外，其余 VLAN 都属于实例0中。</p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="GVRP" term="GVRP"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
        <category label="三层交换机" term="三层交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[MSTP基础配置]]></title>
        <id>https://ddn.org.cn/hcia/mstp-set</id>
        <link href="https://ddn.org.cn/hcia/mstp-set"/>
        <updated>2024-02-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/mstp-set#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p><strong>MSTP</strong></p>
<p>MSTP（Multiple Spanning Tree Protocol）是一种基于 IEEE 802.1Q 标准的 Spanning Tree Protocol（STP）的扩展协议。MSTP 允许网络管理员将网络划分为多个实例，每个实例都可以拥有独立的生成树，以提高网络的容错性和利用率。</p>
<p>MSTP 的主要特点包括：</p>
<ol>
<li>实例化：MSTP 将网络划分为多个实例，每个实例都有一个唯一的实例标识（Instance ID），并可以配置不同的生成树参数。这使得网络管理员可以根据网络的需求和拓扑结构来定制化生成树的计算和转发规则。</li>
<li>区域化：MSTP 支持将网络划分为多个区域，每个区域内可以使用不同的 MSTP 实例。不同的区域之间通过特殊的边界桥（Boundary Bridge）进行连接，边界桥负责转发跨区域的数据。</li>
<li>实例间的互斥：MSTP 确保不同实例之间的生成树是互斥的，这意味着每个实例的生成树都是独立计算的，互不干扰。这样可以实现更细粒度的故障隔离和负载均衡。</li>
<li>兼容性：MSTP 是 STP 的扩展，与 STP 和 RSTP 兼容。它可以与使用 STP 或 RSTP 的设备进行互操作，而不会引入不兼容性问题。</li>
</ol>
<p>MSTP 的引入解决了传统 STP 在大型网络中的一些问题，如生成树计算的复杂性和资源浪费。通过引入实例化和区域化的概念，MSTP 提供了更高效、灵活和可扩展的生成树协议。</p>
<p><strong>MSTP的端口状态</strong></p>
<p>在 MSTP（Multiple Spanning Tree Protocol）中，端口可以具有以下几种不同的状态：</p>
<ol>
<li>Disabled（禁用）：禁用状态表示端口未参与生成树协议，不进行任何生成树计算和数据转发。禁用状态的端口不会发送或接收任何生成树协议的消息。</li>
<li>Blocking（阻塞）：阻塞状态是端口在生成树协议中的初始状态。在阻塞状态下，端口仍然能够接收生成树协议消息，但不会进行数据转发。阻塞状态的目的是防止环路的形成，并在生成树计算中确定生成树的路径。</li>
<li>Listening（监听）：监听状态是端口在从阻塞状态切换到学习状态之前的过渡状态。在监听状态下，端口仍然能够接收生成树协议消息，并开始学习 MAC 地址。但是，端口仍然不会进行数据转发。</li>
<li>Learning（学习）：学习状态是端口在从监听状态切换到转发状态之前的过渡状态。在学习状态下，端口仍然能够接收生成树协议消息，并继续学习 MAC 地址。此时，端口开始建立 MAC 地址表，但仍然不会进行数据转发。</li>
<li>Forwarding（转发）：转发状态是端口在生成树计算完成后的最终状态。在转发状态下，端口能够接收生成树协议消息，并将数据帧转发到相应的端口。转发状态的端口是活动的，可以进行数据转发。</li>
</ol>
<p>这些端口状态的转换是由生成树协议自动进行的，以确保网络中没有环路并提供最佳路径。通过根据网络拓扑和生成树计算来改变端口的状态，MSTP 实现了冗余路径的选择和故障恢复。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/mstp-set#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>掌握MSTP 的基础配置</li>
<li>掌握配置MSTP 多实例的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="模拟环境">模拟环境<a href="https://ddn.org.cn/hcia/mstp-set#%E6%A8%A1%E6%8B%9F%E7%8E%AF%E5%A2%83" class="hash-link" aria-label="模拟环境的直接链接" title="模拟环境的直接链接">​</a></h3>
<p>某公司二层网络由三台交换机S1、S2、S3组成。交换机S1与S2在一个楼层，S3在另一楼层。PC-1与PC-2属于HR部门，划入VLAN10，PC-3与PC-4 属于IT 部门，划入VLAN20。当使用普通STP时，STP 将会阻塞一条链路来防止环路产生，导致该链路闲置。为了保证所有链路都能充分利用，使流量能够分担，网络管理员通过配置MSTP来实现。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/mstp-set#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" alt="1.png" src="https://ddn.org.cn/assets/images/1-131f214e9b167d1b07ec9e63333ba9eb.png" width="905" height="472" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/mstp-set#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<table><thead><tr><th>设备</th><th>接口</th><th>地址/掩码</th><th>所属vlan</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>192.168.10.1/24</td><td>VLAN10</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>192.168.10.2/24</td><td>VLAN10</td></tr><tr><td>PC3</td><td>E0/0/1</td><td>192.168.20.1/24</td><td>VLAN20</td></tr><tr><td>PC4</td><td>E0/0/1</td><td>192.168.20.2/24</td><td>VLAN20</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/mstp-set#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/mstp-set#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" alt="2.png" src="https://ddn.org.cn/assets/images/2-2783b25a023819e09ced950173aea207.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="3.png" src="https://ddn.org.cn/assets/images/3-5773b3ced5373c96bbfa302e8854e5b5.png" width="745" height="452" class="img_ev3q"></p>
<p>其他主机间互相通信测试和上述相同</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置vlan">配置VLAN<a href="https://ddn.org.cn/hcia/mstp-set#%E9%85%8D%E7%BD%AEvlan" class="hash-link" aria-label="配置VLAN的直接链接" title="配置VLAN的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sw1">SW1<a href="https://ddn.org.cn/hcia/mstp-set#sw1" class="hash-link" aria-label="SW1的直接链接" title="SW1的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vlan batch 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface Ethernet0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]interface Ethernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]interface Ethernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/2]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sw2">SW2<a href="https://ddn.org.cn/hcia/mstp-set#sw2" class="hash-link" aria-label="SW2的直接链接" title="SW2的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]vlan batch 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface Ethernet0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]port default vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]interface Ethernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]interface Ethernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sw3">SW3<a href="https://ddn.org.cn/hcia/mstp-set#sw3" class="hash-link" aria-label="SW3的直接链接" title="SW3的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S3]vlan batch 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]interface Ethernet0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/3]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/3]interface Ethernet0/0/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/4]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/4]port default vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/4]interface Eth0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/1]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/1]interface Ethernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/2]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当网络管理员按照设计搭建完公司二层网络后，启动设备。在华为交换机上默认即运行<code>MSTP</code>协议。</p>
<p>在<code>S1</code> 上使用<code>display stp</code>命令查看生成树的状态和统计信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="4.png" src="https://ddn.org.cn/assets/images/4-7f402dff27c83a0ee1de0a5833cae987.png" width="944" height="619" class="img_ev3q"></p>
<p>可以观察到，在<code>CIST</code>全局信息中，显示目前<code>STP</code>模式为<code>MSTP</code>，根交换机为<code>S1</code>自身，另外还有交换机各个接口上的<code>STP</code>信息。使用<code>display stp brief </code>命令查看<code>S1</code>、<code>S2</code>、<code>S3</code> 上生成树的状态和统计的摘要信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp brief</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="5.png" src="https://ddn.org.cn/assets/images/5-56e227c99684d7500368a937db59960f.png" width="904" height="173" class="img_ev3q"></p>
<p><img loading="lazy" alt="6.png" src="https://ddn.org.cn/assets/images/6-092a278dcef1e59d0838014fed1b6c71.png" width="938" height="182" class="img_ev3q"></p>
<p><img loading="lazy" alt="7.png" src="https://ddn.org.cn/assets/images/7-dd7817f9adefba4c3ffe6adae55f9c32.png" width="954" height="210" class="img_ev3q"></p>
<p>可以观察到，此时 <code>S1</code>上的端口都为指定端口，且都处于转发状态，为根交换机。<code>S2</code>上的<code>E0/0/1</code>为替代端口，处于丢弃状态。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置mstp多实例">配置MSTP多实例<a href="https://ddn.org.cn/hcia/mstp-set#%E9%85%8D%E7%BD%AEmstp%E5%A4%9A%E5%AE%9E%E4%BE%8B" class="hash-link" aria-label="配置MSTP多实例的直接链接" title="配置MSTP多实例的直接链接">​</a></h3>
<p><code>MSTP</code>网络由一个或者多个<code>MST</code>域组成，每个<code>MST</code>域中可以包含一个或多个<code>MSTI</code>，即<code>MST</code>实例。<code>MST</code>域中含有一张<code>VLAN</code>映射表，描述了<code>VLAN</code>与<code>MSTI</code>之间的映射关系，默认情况下所有<code>VLAN</code>都映射到<code>MSTI0</code> 中。<code>MSTI</code>之间彼此独立。</p>
<p>在 <code>S1</code> 上配置 <code>MSTP</code> 的多实例。使用 <code>stp region-configuration</code> 命令进入 <code>MST</code> 域视图。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]stp region-configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-mst-region]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用<code>region-name</code>命令配置<code>MST</code>域名为<code>huawei</code>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1-mst-region]region-name huawei</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用<code>revision-level</code>命令配置<code>MSTP</code>的修订级别为<code>1</code>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1-mst-region]revision-level 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用<code>instance</code> 命令指定<code>VLAN10</code>映射到<code>MSTI1</code>，指定<code>VLAN20</code>映射到<code>MSTI 2</code>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1-mst-region]instance 1 vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-mst-region]instance 2 vlan 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用<code>active region-configuration</code>命令激活<code>MST</code> 域配置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1-mst-region]active region-configuration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在<code>S2</code>、<code>S3</code>上做同样配置，但是注意，在同一<code>MST</code>域中，必须具有相同域名、修订级别以及<code>VLAN</code>到<code>MSTI</code>的映射关系。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sw2-1">SW2<a href="https://ddn.org.cn/hcia/mstp-set#sw2-1" class="hash-link" aria-label="SW2的直接链接" title="SW2的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]stp region-configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mst-region]region-name huawei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mst-region]revision-level 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mst-region]instance 1 vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mst-region]instance 2 vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-mst-region]active region-configuration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sw3-1">SW3<a href="https://ddn.org.cn/hcia/mstp-set#sw3-1" class="hash-link" aria-label="SW3的直接链接" title="SW3的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S3]stp region-configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-mst-region]region-name huawei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-mst-region]revision-level 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-mst-region]instance 1 vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-mst-region]instance 2 vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-mst-region]active region-configuration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在<code>S1</code>、<code>S2</code>、<code>S3</code>上使用<code>display stp region-configuration</code>命令查看交换机上当前生效的<code>MST</code>域配置信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp region-configuration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="8.png" src="https://ddn.org.cn/assets/images/8-9b2ec7ca7eebe85bf0d4c94232292ac1.png" width="930" height="274" class="img_ev3q"></p>
<p><img loading="lazy" alt="9.png" src="https://ddn.org.cn/assets/images/9-bd2eeb52b1f0e5959e0a065fb258fb5c.png" width="918" height="277" class="img_ev3q"></p>
<p><img loading="lazy" alt="10.png" src="https://ddn.org.cn/assets/images/10-d739404b5027130fbc0a63146e62a866.png" width="941" height="297" class="img_ev3q"></p>
<p>可以观察到，所有交换机上的 <code>MST</code>域名都为 <code>huawei</code>，修订版本号都为 <code>1</code>，且<code>VLAN</code> 与实例间的映射关系相同，其中除 <code>VLAN 10</code> 与<code>20</code>之外，其余 <code>VLAN</code> 都属于实例<code>0</code>中。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">END.<a href="https://ddn.org.cn/hcia/mstp-set#end" class="hash-link" aria-label="END.的直接链接" title="END.的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="MSTP" term="MSTP"/>
        <category label="STP" term="STP"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[RSTP基础配置]]></title>
        <id>https://ddn.org.cn/hcia/rstp-set</id>
        <link href="https://ddn.org.cn/hcia/rstp-set"/>
        <updated>2024-02-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/rstp-set#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p><strong>RSTP</strong></p>
<p>RSTP（Rapid Spanning Tree Protocol）是一种快速生成和收敛的二层网络冗余协议，是 IEEE 802.1w 标准定义的一种 Spanning Tree Protocol（STP）的改进版本。</p>
<p>RSTP 的主要目标是提供更快的收敛时间，以便在网络发生拓扑变化时更快地恢复和重新计算最短路径树。相比传统的 STP 协议，RSTP 的收敛时间更短，网络恢复更迅速。</p>
<p>以下是 RSTP 的一些关键特点：</p>
<blockquote>
<ol>
<li>端口状态：RSTP 引入了三个新的端口状态：指定端口（Designated Port）、根端口（Root Port）和备份端口（Alternate Port），以提高网络冗余和故障恢复能力。</li>
<li>快速收敛：RSTP 使用了一些机制来加速网络的收敛，例如：端口状态转换的快速学习、边缘端口（Edge Port）的立即转换以及处理拓扑变化的快速通告等。</li>
<li>互操作性：RSTP 与传统的 STP 协议具有向后兼容性，因此可以与使用 STP 的设备进行互操作。</li>
<li>端口类型：RSTP 引入了两种新的端口类型：边缘端口和点对点端口，以减少拓扑变化对整个网络造成的影响。</li>
<li>拓扑变化检测：RSTP 通过发送和接收 BPDU（Bridge Protocol Data Unit）来检测网络拓扑的变化，并相应地进行端口状态的更新和拓扑重计算。</li>
</ol>
</blockquote>
<p>总的来说，RSTP 通过引入新的端口状态、采用快速收敛机制和改进的拓扑变化检测等方法，提供了更快的网络收敛时间和更高的冗余容错能力。这样可以确保网络的高可用性和稳定性，并减少对网络服务的中断时间。</p>
<p><strong>RSTP的端口状态</strong></p>
<p>RSTP（Rapid Spanning Tree Protocol）引入了不同于传统 STP（Spanning Tree Protocol）的端口状态，以提高网络的收敛速度和冗余能力。以下是 RSTP 中的端口状态：</p>
<blockquote>
<ol>
<li>指定端口（Designated Port）：在每个网络段中，RSTP 选举出一个指定端口作为主要的转发端口，用于转发数据帧。指定端口是活动的，并且可以传输数据。</li>
<li>根端口（Root Port）：根端口是一种特殊的指定端口，用于连接到树的根桥。每个非根桥都会选择一条到达树的根桥的最短路径，并将该路径上的端口设置为根端口。</li>
<li>备份端口（Alternate Port）：备份端口是处于阻塞状态的端口，它备份着另一个指定端口，以提供冗余连接。当指定端口发生故障或失效时，备份端口会接管其功能，以确保网络的连通性。</li>
<li>边缘端口（Edge Port）：边缘端口是连接到主机或终端设备的非冗余端口。这些端口可以立即进入指定状态，而无需等待 STP 收敛的过程。边缘端口在启动时不发送 BPDU（Bridge Protocol Data Unit）。</li>
<li>点对点端口（Point-to-Point Port）：点对点端口是直接连接到另一个网桥的端口。这些端口可以更快地收敛，因为它们不需要进行额外的 BPDU 交换。</li>
</ol>
</blockquote>
<p>这些端口状态的引入使 RSTP 能够更快地收敛，并提供更高的冗余容错能力。通过快速决策和转变端口状态，RSTP 可以更迅速地适应网络拓扑变化，减少网络中断和数据包丢失的时间。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/rstp-set#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解RSTP 的应用场景</li>
<li>掌握RSTP 的基本配置</li>
<li>掌握RSTP 的边缘端口的应用</li>
<li>理解RSTP 备份端口</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="模拟环境">模拟环境<a href="https://ddn.org.cn/hcia/rstp-set#%E6%A8%A1%E6%8B%9F%E7%8E%AF%E5%A2%83" class="hash-link" aria-label="模拟环境的直接链接" title="模拟环境的直接链接">​</a></h3>
<p>本实验模拟公司网络场景。<code>S3</code>和<code>S4</code>是接入层交换机，负责用户的接入，<code>S1</code>和<code>S2</code>是汇聚层交换机，四台交换机组成一个环形网络。为了防止网络中出现环路，产生网络风暴，所有交换机上都需要运行生成树协议。同时为了加快网络收敛速度，网络管理员选择使用<code>RSTP</code>协议，且使得性能较好的<code>S1</code>为根交换机，<code>S2</code>为次根交换机，并配置边缘端口进一步优化公司网络。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/rstp-set#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1-f0f5f80ceccac3c54394b5561afcfa6d.png" width="659" height="504" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验配置">实验配置<a href="https://ddn.org.cn/hcia/rstp-set#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链�接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试连通性">测试连通性<a href="https://ddn.org.cn/hcia/rstp-set#%E6%B5%8B%E8%AF%95%E8%BF%9E%E9%80%9A%E6%80%A7" class="hash-link" aria-label="测试连通性的直接链接" title="测试连通性的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-9841094c330d531e6adb98cc7968fcd4.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="3.png" src="https://ddn.org.cn/assets/images/3-72766a2b205ba5a0edd26637434edf39.png" width="781" height="533" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置rstp基本功能">配置RSTP基本功能<a href="https://ddn.org.cn/hcia/rstp-set#%E9%85%8D%E7%BD%AErstp%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="配置RSTP基本功能的直接链接" title="配置RSTP基本功能的直接链接">​</a></h3>
<p>在汇聚层交换机<code>S1</code>、<code>S2</code>及接入层交换机<code>S3</code>、<code>S4</code>上，把生成树模式由默认的<code>MSTP</code>改为<code>RSTP</code>。由于华为交换机上默认即开启了<code>MSTP</code>，故只需修改生成树模式即可。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]stp mode rstp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]stp mode rstp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]stp mode rstp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4]stp mode rstp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，在交换机<code>S1</code>、<code>S2</code>、<code>S3</code>和<code>S4</code>上都使用<code>display stp</code>命令去查看生成树的模式及根交换机的位置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="4.png" src="https://ddn.org.cn/assets/images/4-60b6f4eb5f8ca744508c49b88ce75d9b.png" width="1080" height="351" class="img_ev3q"></p>
<p><img loading="lazy" alt="5.png" src="https://ddn.org.cn/assets/images/5-d0130d4e28e2800302b0aa0b90a33789.png" width="1080" height="354" class="img_ev3q"></p>
<p><img loading="lazy" alt="6.png" src="https://ddn.org.cn/assets/images/6-24a623818edaa93dd8031c9b43a484e1.png" width="1080" height="343" class="img_ev3q"></p>
<p><img loading="lazy" alt="7.png" src="https://ddn.org.cn/assets/images/7-1a30f9e3d18f8c4751e86e1ae92c2cd8.png" width="1080" height="359" class="img_ev3q"></p>
<p>上述信息中，<strong>CIST Bridge</strong> 是交换机自己的ID，而<strong>CISTRoot</strong>是根交换机的ID。根交换机是交换机ID最小的交换机，所以，观察可知，<code>S4</code>是当前的根交换机。</p>
<p>在RSTP构建的树形拓扑中，网络管理员需要设置汇聚层主交换机<code>S1</code>为根交换机，汇聚层交换机<code>S2</code>为备份根交换机。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]stp root primary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]stp root secondary</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，同样在<code>S1</code> 上使用<code>display stp</code>命令观察。</p>
<p><img loading="lazy" alt="8.png" src="https://ddn.org.cn/assets/images/8-e2c981ea0c28424c6d94552c0d411066.png" width="1080" height="358" class="img_ev3q"></p>
<p>可以观察到，<code>stp root primary</code> 命令修改的是交换机ID 中的交换机优先级，把默认的优先级由<code>32768</code> 改为0，所以<code>S1</code>的交换机ID 变为最小，是<strong>Primary root</strong>，即根交换机</p>
<p>同样在<code>S2</code> 上使用<code>display stp</code>命令观察。</p>
<p><img loading="lazy" alt="9.png" src="https://ddn.org.cn/assets/images/9-8b3ca892f53096e6f21064b0aa19a07d.png" width="1080" height="359" class="img_ev3q"></p>
<p>可以观察到，<code>stprootsecondary</code> 命令修改的也是交换机ID 中的交换机优先级，把默认的优先级由<code>32768</code> 改为<code>4096</code>，使<code>S2</code> 的桥ID 变为次小，是<strong>Secondaryroot</strong>，即次根交换机。</p>
<p>继续使用<code>display stp brief</code> 命令查看每台交换机上的端口角色及状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp brief</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="10.png" src="https://ddn.org.cn/assets/images/10-eef757a8ebc20a41cada184b459384fb.png" width="1006" height="125" class="img_ev3q"></p>
<p><img loading="lazy" alt="11.png" src="https://ddn.org.cn/assets/images/11-5747e53b2a63b6e80af9feefb509b8b3.png" width="892" height="128" class="img_ev3q"></p>
<p><img loading="lazy" alt="12.png" src="https://ddn.org.cn/assets/images/12-c208e69d78df77a0b12ffb51e71b5a98.png" width="899" height="132" class="img_ev3q"></p>
<p><img loading="lazy" alt="13.png" src="https://ddn.org.cn/assets/images/13-f8c643310c1c83e81178c6c1b8751803.png" width="1006" height="125" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置边缘端口">配置边缘端口<a href="https://ddn.org.cn/hcia/rstp-set#%E9%85%8D%E7%BD%AE%E8%BE%B9%E7%BC%98%E7%AB%AF%E5%8F%A3" class="hash-link" aria-label="配置边缘端口的直接链接" title="配置边缘端口的直接链接">​</a></h3>
<p>生成树的计算主要发生在交换机互连的链路之上，而连接 PC的端口没有必要参与生成树计算，为了优化网络，降低生成树计算对终端设备的影响，现在网络管理员把交换机上连接PC的接口配置为边缘端口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S4]interface Ethernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4-Ethernet0/0/1]stp edged-port enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]interface Ethernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/1]stp edged-port enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置S4上连接PC的端口为边缘端口，此时生成树计算工作依然进行，但端口进入转发状态无需等待30s。</p>
<p><img loading="lazy" alt="14.png" src="https://ddn.org.cn/assets/images/14-eef757a8ebc20a41cada184b459384fb.png" width="1006" height="125" class="img_ev3q"></p>
<p>可以观察到，接口立刻进入到<code>Forwarding</code>状态，没有30s的延迟。在使用<code>RSTP</code>的环境中，可以在交换机上把连接PC、路由器和防火墙的端口都配置为边缘端口，边缘端口能降低终端设备访问网络需要等待的时间，明显提高网络的可用性。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="end">End.<a href="https://ddn.org.cn/hcia/rstp-set#end" class="hash-link" aria-label="End.的直接链接" title="End.的直接链接">​</a></h2>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="RSTP" term="RSTP"/>
        <category label="STP" term="STP"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[STP简单配置]]></title>
        <id>https://ddn.org.cn/hcia/stp-set</id>
        <link href="https://ddn.org.cn/hcia/stp-set"/>
        <updated>2024-02-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/stp-set#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是stp">什么是STP？<a href="https://ddn.org.cn/hcia/stp-set#%E4%BB%80%E4%B9%88%E6%98%AFstp" class="hash-link" aria-label="什么是STP？的直接链接" title="什么是STP？的直接链接">​</a></h3>
<p>STP（Spanning Tree Protocol）是一种用于防止网络中出现环路的协议。在局域网中，当存在多个交换机连接时，可能会形成环路，导致数据包在网络中无限循环，从而引发网络拥塞和广播风暴。</p>
<p>STP 协议通过在网络中选择一个主交换机（Root Bridge），并在其它交换机之间建立一颗无环的树状拓扑结构，来解决环路问题。该树状拓扑中的路径称为"最短路径树"（Spanning Tree），其中只有一个路径可用，其它路径被阻塞。</p>
<p>STP 协议的工作原理是通过交换机之间的 BPDU（Bridge Protocol Data Units）消息进行交互，进行根桥的选举和端口状态的协商。BPDU 消息包含了交换机的标识、优先级等信息，通过比较这些信息来确定根桥和最短路径。</p>
<p>当网络中有新的交换机加入或旧的交换机离开时，STP 会重新计算最短路径树，以适应网络的变化。它会通过阻塞或开放某些端口，确保网络中没有环路，并提供冗余路径以提高网络的可靠性。</p>
<p>STP 协议有多个版本，如经典的 STP（IEEE 802.1D）、快速 STP（Rapid Spanning Tree Protocol，RSTP，IEEE 802.1w）和多实例 STP（Multiple Spanning Tree Protocol，MSTP，IEEE 802.1s）。这些版本在性能和功能上有所区别，但都是为了解决网络中的环路问题。</p>
<p>STP（Spanning Tree Protocol）协议中常用的端口包括以下几种：</p>
<blockquote>
<ol>
<li>
<p>Root Port（根端口）：根端口是指连接到最短路径树上的最短路径的端口。在每个非根交换机上，与根桥之间的连接上具有最小路径代价的端口会被选为根端口。每个桥/交换机只能有一个根端口。</p>
</li>
<li>
<p>Designated Port（指定端口）：指定端口是指连接到特定网段上的端口。在每个网段上，与根桥之间的连接上具有最小路径代价的端口会被选为指定端口。每个网段只能有一个指定端口。</p>
</li>
<li>
<p>Non-Designated Port（非指定端口）：非指定端口是指除了根端口和指定端口之外的所有端口。非指定端口会被阻塞，以确保网络中没有环路。当有多个非指定端口连接到同一个交换机时，其中代价最大的端口会被阻塞。</p>
</li>
</ol>
</blockquote>
<p>这些端口状态是 STP 协议运行时根据交换机之间的链路状态和路径代价进行计算和选择的。通过根端口和指定端口，STP 协议构建了一棵无环的最短路径树，以确保数据在网络中能够正确地转发和到达目的地。非指定端口则起到了阻塞的作用，以避免环路的产生。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/stp-set#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解STP 的选举过程</li>
<li>掌握修改交换机优先级的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容模拟场景">实验内容/模拟场景<a href="https://ddn.org.cn/hcia/stp-set#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%E6%A8%A1%E6%8B%9F%E5%9C%BA%E6%99%AF" class="hash-link" aria-label="实验内容/模拟场景的直接链接" title="实验内容/模拟场景的直接链接">​</a></h3>
<p>公司购置了4台交换机，组建网络。考虑到网络的可靠性，将4台交换机如图所示拓扑搭建。由于默认情况下，交换机之间运行STP后，根交换机、根端口、指定端口的选择将基于交换机的MAC地址的大小，因此带来了不确定性，极可能由此产生隐患。公司网络规划，需要 <code>S1</code>作为主根交换机，<code>S2</code>作为<code>S1</code>的备份根交换机。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/stp-set#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1-13213d1bf789f8e91af821dd3d527503.png" width="619" height="311" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置环节">配置环节<a href="https://ddn.org.cn/hcia/stp-set#%E9%85%8D%E7%BD%AE%E7%8E%AF%E8%8A%82" class="hash-link" aria-label="配置环节的直接链接" title="配置环节的直接链接">​</a></h2>
<p>根据拓扑图，在交换机上启用STP(华为交换机默认启用MSTP)将交换机的STP模式更改为普通生成树STP。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]stp enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]stp mode stp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]stp enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]stp mode stp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]stp enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]stp mode stp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4]stp enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S4]stp mode stp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，默认情况下需要等待30s生成树重新计算的时间(15s Forward Delay加上15s Learning 状态时间)，再使用<code>display stp</code>命令查看<code>S1</code>的生成树状态。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-f3df8f28217fa6d27eeedd74f31c170c.png" width="898" height="632" class="img_ev3q"></p>
<p>还可以使用<code>display stp brief</code>命令<code>S1</code>、<code>S2</code>、<code>S3</code>、<code>S4</code> 上仅查看摘要信息</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display stp brief</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-48ae7f3e568eca454e3ab314a60165fd.png" width="898" height="165" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/4-1c58372370cf6a1c6bf3fe8be022c9fa.png" width="898" height="167" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/5-ca3f04676d3757f0376f8663c8192a86.png" width="898" height="165" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/6-5457e3bcbc8b54fdf5506234ad811890.png" width="898" height="166" class="img_ev3q"></p>
<p>在交换机<code>S3</code>上所有的端口角色都为指定端口，且端口状态都为转发。</p>
<p>可以初步判断4台交换机中<code>S3</code>为根交换机，因为该交换机所有端口都为指定端口。</p>
<p>生成树运算第一步就是通过比较每台交换机的ID选举根交换机。交换机ID由交换机优先级和 MAC 地址组成，首先比较交换机优先级数值最低的为根交换机;如果优先级一样，则比较MAC地址，同样数值最低的选举为根交换机。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置网络中的根交换机">配置网络中的根交换机<a href="https://ddn.org.cn/hcia/stp-set#%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E6%A0%B9%E4%BA%A4%E6%8D%A2%E6%9C%BA" class="hash-link" aria-label="配置网络中的根交换机的直接链接" title="配置网络中的根交换机的直接链接">​</a></h3>
<p>根交换机在网络中的位置是非常重要的，如果选择了一台性能较差的交换机，或者是部署在接入层的交换机作为根交换机，会影响到整个网络的通信质量及数据传输。所以确定根交换机的位置极为重要。根交换机选举依据是根交换机 ID，值越小越优先，交换机默认的优先级为 <code>32768</code>，当然该值是可以修改的。</p>
<p>现在将<code>S1</code>配置为主根交换机，<code>S2</code>为备份根交换机，将<code>S2</code>的优先级改为0，<code>S1</code>的优先级改为<code>4096</code>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]stp priority 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]stp priority 4096</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后查看<code>S1</code>和<code>S2</code>的STP状态信息。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/7-f6ed8d3ef707e8aebd0f9d809c0cbf43.png" width="898" height="632" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/8-c3adf47e9d5cd7f48ffc60b8ee8ee453.png" width="898" height="632" class="img_ev3q"></p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="STP" term="STP"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[利用三层交换机实现VLAN 间路由]]></title>
        <id>https://ddn.org.cn/hcia/bx61ns911ubehyfk</id>
        <link href="https://ddn.org.cn/hcia/bx61ns911ubehyfk"/>
        <updated>2024-01-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="关于本实验的所需要的知识点补充">关于本实验的所需要的知识点补充<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%85%B3%E4%BA%8E%E6%9C%AC%E5%AE%9E%E9%AA%8C%E7%9A%84%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E5%85%85" class="hash-link" aria-label="关于本实验的所需要的知识点补充的直接链接" title="关于本实验的所需要的知识点补充的直接链接">​</a></h3>
<p><strong>vlanif</strong></p>
<p>VLANIF（Virtual Local Area Network Interface）是一种虚拟局域网接口，它是基于 VLAN 技术的扩展。在网络中，VLAN 是一种将局域网划分成多个虚拟局域网的技术，可以在单个物理网络中实现逻辑上的隔离和划分。而 VLANIF 就是在每个虚拟局域网中创建的一个虚拟接口，用于与该虚拟局域网内的设备进行交互和通信。VLANIF 接口可以配置 IP 地址和其他网络参数，实现虚拟局域网中的互联和通信功能。它在网络中起到连接不同 VLAN 之间的桥梁作用，可以将不同的 VLAN 划分成多个子网，并提供路由功能，实现不同子网之间的通信。</p>
<p>VLANIF 之间的路由是指不同 VLANIF 接口之间进行网络路由的过程。在一个网络中，每个 VLANIF 接口都代表一个虚拟局域网，而这些虚拟局域网可能存在跨网段的通信需求。为了实现不同 VLANIF 之间的通信，需要进行路由配置。</p>
<p>在路由器或三层交换机上，需要创建虚拟接口并将其分配给相应的 VLAN。这些虚拟接口通常称为 SVI（Switched Virtual Interface），每个 SVI 与一个 VLAN 关联。通过在 SVI 上配置 IP 地址和子网掩码，可以为每个 VLAN 创建一个虚拟网关。</p>
<p>当数据包从一个 VLANIF 接口发送到另一个 VLANIF 接口时，数据包首先到达路由器或三层交换机上的 SVI 接口。然后，根据路由表中的路由信息，决定数据包应该被发送到哪个目标 VLANIF 接口。</p>
<p>通过在路由器或三层交换机上配置适当的路由策略和路由协议，可以实现 VLANIF 之间的互联和通信。这样，不同 VLAN 中的主机就可以通过 VLANIF 之间的路由进行互相访问和通信。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ol>
<li>掌握配置VLANIF接口的方法</li>
<li>理解数据包跨VLAN路由的原理</li>
<li>掌握测试多层交换网络连通性的方法</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟企业网络场景。公司有两个部门--销售部和客服部，分别规划使用VLAN 10和VLAN20。其中销售部下有两台终端PC-1和PC-2，客服部下有一台终端PC-3。所有终端都通过核心三层交换机S1相连。现需要让该公司所有三台主机都能实现互相访问，网络管理员将通过配置三层交换机来实现。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1-9c6d9cb29b3b04af4b85058a5449f57a.png" width="829" height="639" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<table><tbody><tr><th>设备</th><th>接口</th><th>IP地址/掩码</th><th>网关</th></tr><tr><th>PC1</th><td>E0/0/1</td><td>192.168.1.1/24</td><td>192.168.1.254</td></tr><tr><th>PC2</th><td>E0/0/1</td><td>192.168.1.2/24</td><td>192.168.1.254</td></tr><tr><th>PC3</th><td>E0/0/1</td><td>192.168.2.1/24</td><td>192.168.2.254</td></tr><tr><th rowspan="4">S1</th></tr><tr><td>VLANIF10</td><td>192.168.1.254</td></tr><tr><td>VLANIF20</td><td>192.168.2.254</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h2>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-00ad94d77e6a08b351a3a2496f90fdfe.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-aaaff95d4ae76d08702f0b0558bb6734.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/4-3447e00ceb6bc743cf134e2ecd49752d.png" width="781" height="533" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="其他操作">其他操作<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C" class="hash-link" aria-label="其他操作的直接链接" title="其他操作的直接链接">​</a></h3>
<p>配置三层交换机实现VLAN间通信通过在交换机上设置不同的VLAN使得主机实现相互隔离。在三层交换机S1上创建VLAN10和VLAN 20，把销售部的主机全部划入VLAN 10 中，客服部的主机划入VLAN 20 中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan10]vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan20]interface GigabitEthernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port default VLAN 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]port default VLAN 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]interface GigabitEthernet0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]port default VLAN 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S1上使用 interface VLANif命令创建 VLANIF 接口，指定VLANIF 接口所对应的 VLAN ID 为10，并进入 VLANIF 接口视图，在接口视图下配置IP 地址192.168.1.254/24。再创建 对应 VLAN 20 的VLANIF 接口，地址配置为192.168.2.254/24。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface VLANif 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-VLANif10]ip address 192.168.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-VLANif10]interface VLANif 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-VLANif20]ip address 192.168.2.254 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，查看接口状态。</p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/5-02b8910fe077072e45f68534851f8ad3.png" width="1080" height="419" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="结果验证">结果验证<a href="https://ddn.org.cn/hcia/bx61ns911ubehyfk#%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%81" class="hash-link" aria-label="结果验证的直接链接" title="结果验证的直接链接">​</a></h2>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/6-ccd5ada9fc87805e85ab0a610cdf227d.png" width="781" height="533" class="img_ev3q"></p>
<p>可见通信正常，实现了销售部终端与客服部终端间的通信。PC-2上的测试省略。</p>
<p><strong>本文完</strong></p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="VLAN" term="VLAN"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[利用单臂路由实现VLAN间路由]]></title>
        <id>https://ddn.org.cn/hcia/rw6oklzd03ngri7n</id>
        <link href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n"/>
        <updated>2024-01-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="单臂路由">单臂路由<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%8D%95%E8%87%82%E8%B7%AF%E7%94%B1" class="hash-link" aria-label="单臂路由的直接链接" title="单臂路由的直接链接">​</a></h3>
<p>单臂路由（One-armed routing）是一种网络路由配置方法，通常在网络设备（如防火墙或负载均衡器）的部署中使用。在单臂路由中，网络设备只使用一个物理接口与网络中的其他设备进行通信。</p>
<p>具体来说，单臂路由通过将网络设备的一个接口（称为单臂接口）连接到网络的主干或核心部分，然后使用该接口作为该设备与其他设备进行通信的路径。这意味着所有的数据流量都需要通过单臂接口进入和离开网络设备。</p>
<p>单臂路由的主要目的是实现流量监控、访问控制和网络安全策略等。通过集中管理和控制网络流量，可以更容易地实施网络安全措施，如防火墙规则、负载均衡策略等。</p>
<p>然而，单臂路由也可能导致一些性能和可扩展性方面的限制。由于所有的数据流量都必须经过单臂接口，可能会产生瓶颈和延迟。另外，单臂路由也可能限制网络的规模和扩展性。</p>
<p>需要注意的是，单臂路由是一种特定的网络配置方法，并不是所有情况下都适用。在实际应用中，需要根据具体的网络需求和环境来选择使用单臂路由还是其他路由配置方法。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<blockquote>
<ol>
<li>理解单臂路由的应用场景</li>
<li>掌握路由器子接口的配置方法·</li>
<li>掌握子接口封装 VLAN 的配置方法</li>
<li>理解单臂路由的工作原理</li>
</ol>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验内容">实验内容<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接">​</a></h3>
<p>本实验模拟公司网络场景。路由器 R1 是公司的出口网关，员工 PC 通过接入层交换机(如 S2 和 S3)接入公司网络，接入层交换机又通过汇聚交换机 S1 与路由器 R1 相连。公司内部网络通过划分不同的 VLAN 隔离了不同部门之间的二层通信，保证各部门间的信息安全，但是由于业务需要，经理、市场部和人事部之间需要能实现跨 VLAN 通信，网络管理员决定借助路由器的三层功能，通过配置单臂路由来实现。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/1-8dc3b7cad7682820a1d82c54f77d332e.png" width="830" height="689" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验编址">实验编址<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%AE%9E%E9%AA%8C%E7%BC%96%E5%9D%80" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接">​</a></h3>
<table><tbody><tr><th>设备</th><th>接口</th><th>编址</th><th>网关</th></tr><tr><th rowspan="4">R1</th></tr><tr><td>G0/0/1.1</td><td>192.168.1.254/24</td></tr><tr><td>G0/0/1.2</td><td>192.168.2.254/24</td></tr><tr><td>G0/0/1.3</td><td>192.168.1.254/24</td></tr><tr><th>PC1</th><td>E0/0/1</td><td>192.168.1.1/24</td><td>192.168.1.254</td></tr><tr><th>PC2</th><td>E0/0/1</td><td>192.168.2.1/24</td><td>192.168.2.254</td></tr><tr><th>PC3</th><td>E0/0/1</td><td>192.168.3.1/24</td><td>192.168.3.254</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验步骤">实验步骤<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4" class="hash-link" aria-label="实验步骤的直接链接" title="实验步骤的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建vlan并配置accesstrunk接口">创建VLAN并配置Access、Trunk接口<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E5%88%9B%E5%BB%BAvlan%E5%B9%B6%E9%85%8D%E7%BD%AEaccesstrunk%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="创建VLAN并配置Access、Trunk接口的直接链接" title="创建VLAN并配置Access、Trunk接口的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s2的配置代码">S2的配置代码<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#s2%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="S2的配置代码的直接链接" title="S2的配置代码的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-vlan10]vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-vlan20]interface Ethernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]interface Ethernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port default vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s3的配置代码">S3的配置代码<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#s3%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="S3的配置代码的直接链接" title="S3的配置代码的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S3]vlan 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-vlan30]interface Ethernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/1]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-Ethernet0/0/1]port default vlan 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S3-GigabitEthernet0/0/2]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s1的配置代码">S1的配置代码<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#s1%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="S1的配置代码的直接链接" title="S1的配置代码的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan10]vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan20]vlan 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan30]interface GigabitEthernet 0/0/2`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]interface GigabitEthernet 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]port link-type trunk`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]port trunk allow-pass vlan all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port link-type trunks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port trunk allow-pass vlan all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置路由器子接口和ip地址">配置路由器子接口和IP地址<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%90%E6%8E%A5%E5%8F%A3%E5%92%8Cip%E5%9C%B0%E5%9D%80" class="hash-link" aria-label="配置路由器子接口和IP地址的直接链接" title="配置路由器子接口和IP地址的直接链接">​</a></h3>
<ol>
<li>在 R1 上创建子接口 GE 0/0/1.1，配置 IP 地址 192.168.1.254/24,作为人事部网关地址。</li>
<li>在 R1 上创建子接口 GE 0/0/1.2，配置 IP 地址 192.168.2.254/24,作为市场部网关地址。</li>
<li>在 R1 上创建子接口 GE 0/0/1.3，配置 IP 地址 192.168.3.254/24,作为经理网关地址。</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.1]ip address 192.168.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.2]ip address 192.168.2.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.3]ip address 192.168.3.254 24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置路由器子接口封装vlan">配置路由器子接口封装VLAN<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%90%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85vlan" class="hash-link" aria-label="配置路由器子接口封装VLAN的直接链接" title="配置路由器子接口封装VLAN的直接链接">​</a></h3>
<p>在R1的子接口GE 0/0/1.1 上封装VLAN 10，在子接口GE 0/0/1.2上封装VLAN 20，在子接口GE 0/0/1.3上封装VLAN 30，并开启子接口的ARP 广播功能。</p>
<p>使用arp broadcast enable 命令开启子接口的ARP 广播功能。如果不配置该命令，将会导致该子接口无法主动发送ARP广播报文，以及向外转发IP报文。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.1]dot1q termination vid 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.1]arp broadcast enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>同理配置R1的子接口GE 0/0/1.2 和GE 0/0/1.3。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.2]dot1q termination vid 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.2]arp broadcast enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1]interface GigabitEthernet 0/0/1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.3]dot1q termination vid 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[R1-GigabitEthernet0/0/1.3]arp broadcast enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="测试结果">测试结果<a href="https://ddn.org.cn/hcia/rw6oklzd03ngri7n#%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C" class="hash-link" aria-label="测试结果的直接链接" title="测试结果的直接链接">​</a></h2>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/2-f65daa4dfce11732ced81e7615aa4475.png" width="799" height="613" class="img_ev3q"></p>
<p><img loading="lazy" src="https://ddn.org.cn/assets/images/3-134de2506984372e7d70919cb1d46018.png" width="799" height="613" class="img_ev3q"></p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="VLAN" term="VLAN"/>
        <category label="实验" term="实验"/>
        <category label="单臂路由" term="单臂路由"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[VLAN 基础配置之理解Hybrid 接口]]></title>
        <id>https://ddn.org.cn/hcia/vlan-set-switch-hybrid</id>
        <link href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid"/>
        <updated>2024-01-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[关于本实验的所需要的知识点补充]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="关于本实验的所需要的知识点补充">关于本实验的所需要的知识点补充<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E5%85%B3%E4%BA%8E%E6%9C%AC%E5%AE%9E%E9%AA%8C%E7%9A%84%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E5%85%85" class="hash-link" aria-label="关于本实验的所需要的知识点补充的直接链接" title="关于本实验的所需要的知识点补充的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hybrid">hybrid<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#hybrid" class="hash-link" aria-label="hybrid的直接链接" title="hybrid的直接链接">​</a></h3>
<p>在华为交换机中，Hybrid 接口通常指的是支持同时传输多种不同协议或介质的接口。它是指在单个接口上可以同时支持不同类型的数据传输，比如同时支持以太网和光纤通信。</p>
<p>具体来说，在华为交换机中的 Hybrid 接口一般是指具备多种物理接口和传输方式的端口。这些接口可以同时支持不同速率、不同类型的数据传输，例如同时支持 Ethernet（以太网）和 Fiber Channel（光纤通道）的数据传输。</p>
<p>Hybrid 接口的设计使得华为交换机可以更灵活地适应各种网络需求，并提供更多样化的连接选项。通过配置 Hybrid 接口，网络管理员可以根据实际需求选择不同的物理介质和协议，以满足不同设备和应用之间的连接要求。</p>
<p>需要注意的是，Hybrid 接口的具体配置和功能可以因不同的华为交换机型号和软件版本而有所不同。因此，如果在具体的华为交换机设备上使用 Hybrid 接口，建议参考相应的设备文档或联系华为技术支持获取更准确和详细的信息。</p>
<p>在华为交换机中，Hybrid 接口具有以下作用：</p>
<blockquote>
<ol>
<li>多协议支持：Hybrid 接口可以同时支持多种不同的协议，如以太网、光纤通道（Fiber Channel）等。这样可以满足网络中的不同设备和应用之间的协议要求，实现灵活的数据传输。</li>
<li>多介质支持：Hybrid 接口可以同时支持不同的物理介质，如 RJ-45（铜缆）和光纤等。这样可以适应不同的网络环境和需求，实现灵活的网络连接。</li>
<li>弹性配置：通过配置 Hybrid 接口，可以根据实际需求选择合适的协议和介质，并灵活调整接口参数。这样可以根据网络的变化和要求来优化和调整接口的配置。</li>
<li>提高网络利用率：Hybrid 接口的多协议和多介质支持，使得网络设备可以更有效地利用资源。例如，可以通过 Hybrid 接口将不同类型的设备连接到同一个交换机上，从而简化网络拓扑结构，提高网络资源的利用效率。
总之，Hybrid 接口在华为交换机中的作用是为了提供更灵活、可扩展和兼容的网络连接选项，以满足不同设备和应用之间的协议和介质要求，并提高网络资源的利用效率。</li>
</ol>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h2>
<ul>
<li>掌握配置Hybrid 接口的方法</li>
<li>理解Hybrid 接口处理Untagged 数据帧过程</li>
<li>理解Hybrid 接口处理Tagged 数据帧过程</li>
<li>理解Hybrid 接口的应用场景</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验背景">实验背景<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E5%AE%9E%E9%AA%8C%E8%83%8C%E6%99%AF" class="hash-link" aria-label="实验背景的直接链接" title="实验背景的直接链接">​</a></h2>
<p>某企业二层网络使用两台 S3700 交换机 S1 和 S2，且两台设备在不同的楼层。网络管理员规划了 3 个不同 VLAN，HR 部门使用 VLAN10，市场部门使用 VLAN 20，IT 部门使用 VLAN30。现在需要让处于不同楼层的 HR 部门和市场部门实现部门内部通信，而两部门之间不允许互相通信;IT 部门可以访问任意部门。可以通过配置 Hybrid 接口来实现较复杂的 VLAN 控制。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/1-28def0a1ffd84043838c970c994615b1.png" width="716" height="553" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验任务配置">实验任务配置<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E5%AE%9E%E9%AA%8C%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验任务配置的直接链接" title="实验任务配置的直接链接">​</a></h3>
<p><strong>IP 地址规划</strong></p>
<table><thead><tr><th>设备</th><th>接口</th><th>地址</th><th>vlan</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>192.168.1.1</td><td>20</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>192.168.1.2</td><td>10</td></tr><tr><td>PC3</td><td>E0/0/1</td><td>192.168.1.3</td><td>20</td></tr><tr><td>PC4</td><td>E0/0/1</td><td>192.168.1.4</td><td>10</td></tr><tr><td>PC5</td><td>E0/0/1</td><td>192.168.1.100</td><td>30</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/2-49235d8ce6008978e3d00fae267a3099.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/3-20e7b010ba93afb242dbed06de6be3af.png" width="781" height="533" class="img_ev3q"></p>
<p><em><strong>*其他主机间互相通信测试和上述相同*</strong></em></p>
<p><strong>创建 vlan</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s1]vlan batch 10 20 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2]vlan batch 10 20 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>配置 hybrid</strong></p>
<p>因为ensp接口类型默认是hybrid，下面我会提供的一些命令参考</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">port link-type hybrid</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接口类型改为hybrid</p>
<p>S1的配置</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1]int Eth 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]port hybrid tagged vlan 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1]int Eth 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/2]port hybrid untagged vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/2]port hybrid pvid vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1]int Eth 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]port hybrid untagged vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]port hybrid pvid vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>S2的配置</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]int Eth 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]port hybrid tagged vlan 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2]int Eth 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port hybrid untagged vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port hybrid pvid vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]int Eth 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]port hybrid untagged vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]port hybrid pvid vlan 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后，使用display vlan命令查看使用Hybrid配置下接口和VLAN的对应关系。</p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/4-76049321c22373491680702bd9b6f654.png" width="1080" height="770" class="img_ev3q"></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/5-ffd1d330accfb2490824e67913f6d544.png" width="1080" height="768" class="img_ev3q"></p>
<p>*<strong>5*</strong></p>
<h2></h2>
<p>**延伸部分
**</p>
<p>实现网管员对所有网络的访问在实现各部门内部终端可以互相访问，不同部门间的终端隔离访问后，要求网络管理员所在的 I 部门(使用终端 PC-5)能够实现对所有部门的访问。即要求实现 VLAN 30 访问 VLAN10 和 VLAN 20，VLAN 10 和 VLAN 20 之间仍然不允许互相访问。如果 S1 的 E 0/0/2 接口仍是 Access 类型且属于 VLAN10，则不能被其他 VLAN 访问。若要 VLAN 30 的终端能访问 VLAN 10 的终端，则需要修改接口的配置，使其既能被 VLAN 10 访问，又能被 VLAN 30 访问，这就要求此接口同时要属于多个 VLAN，且端口所连设备是 PC，不能识别带 VLAN Tag 的帧，故此时只能使用 Hybrid 类型接口。Hybrid 端口既能被加入多个 VLAN 中，又能够在将其余 VLAN 的帧转发到此接口时，剥离掉相应的 VLAN Tag。</p>
<p>S1的配置</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]int Eth 0/0/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/4]port hybrid pvid vlan 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/4]port hybrid untagged vlan 10 20 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]int Eth 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/2]port hybrid untagged vlan 20 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]int Eth 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/3]port hybrid untagged vlan 10 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]int Eth 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Ethernet0/0/1]port hybrid tagged vlan 10 20 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>S2的配置</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]int Eth 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/1]port hybrid tagged vlan 10 20 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]int Eth 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/2]port hybrid untagged vlan 20 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2]int Eth 0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Ethernet0/0/3]port hybrid untagged vlan 10 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="结果验证">结果验证<a href="https://ddn.org.cn/hcia/vlan-set-switch-hybrid#%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%81" class="hash-link" aria-label="结果验证的直接链接" title="结果验证的直接链接">​</a></h2>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/6-17fe2c8587cbdd0b462451ef9462fca5.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/7-4d33ea464595748aa64fd486c1773a9d.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/8-ce79268bec1e1ebd9f0f4104af4443e3.png" width="781" height="533" class="img_ev3q"></p>
<p>在交换机上可以定义多个 VLAN，每个 VLAN 都可以看做是一个广播域，通常情况下每个 VLAN 都会分配一个独立的 IP 网络，根据需要把相应主机所在的接口划入到指定的 VLAN 中，并配置相应的网络 IP 地址，VLAN 间通过路由来实现互相访问。</p>
<p>这是较为常用的方法。但是相比于基于端口的 Hybrid 配置，三层路由方式则不够灵活，原因在于 VLAN 之间的访问控制要借助于路由设备来实现。</p>
<p>而控制 VLAN 访问使用 Hybrid 接口则极大地简化了配置的复杂性，它仅需在端口上自主定义基于 VLAN Tag 的过滤规则，来决定指定的 VLAN 的二层帧是否允许发送;它是通过二层来实现 VLAN 间的访问控制，既不需要每个 VLAN 定义单独的 IP 网段，更不需要在 VLAN 间引入路由设备，配置更为灵活方便。</p>
<p><strong>本文完</strong></p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="VLAN" term="VLAN"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[VLAN 基础配置之配置Trunk 接口]]></title>
        <id>https://ddn.org.cn/hcia/vlan-set-switch-trunk</id>
        <link href="https://ddn.org.cn/hcia/vlan-set-switch-trunk"/>
        <updated>2024-01-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接">​</a></h2>
<p>关于本实验的所需要的知识点补充</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="trunk部分">trunk部分<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#trunk%E9%83%A8%E5%88%86" class="hash-link" aria-label="trunk部分的直接链接" title="trunk部分的直接链接">​</a></h3>
<p>VLAN 传输：trunk 端口可以传输多个 VLAN 的数据。它使用 VLAN 标记协议（如 IEEE 802.1Q）来在数据包中添加 VLAN 标记，以标识数据包属于哪个 VLAN。</p>
<p>配置方式：trunk 端口需要在交换机上进行配置。管理员需要将相应的端口配置为 trunk 端口，并指定所传输的 VLAN 列表。这样交换机才能正确地进行 VLAN 标记和数据转发。</p>
<p>连接交换机：trunk 端口通常用于连接两个交换机之间的接口。通过这样的连接，交换机可以交换多个 VLAN 的数据，并提供灵活性和效率。</p>
<p>数据传输：当数据从一个交换机通过 trunk 端口发送到另一个交换机时，发送端交换机会在数据包的以太网帧中添加 VLAN 标记，以标识数据包所属的 VLAN。接收端交换机会根据 VLAN 标记将数据包转发到相应的 VLAN。</p>
<p>需要注意的是，trunk 端口一般不用于连接终端设备（如计算机或打印机），而是用于连接交换机之间的接口，以实现多个 VLAN 的数据传输。总结起来，trunk 端口是在交换机上配置为传输多个 VLAN 数据的接口。它通过 VLAN 标记协议在数据包中添加 VLAN 标记，并允许交换机之间进行多个 VLAN 的数据传输。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解干道链路的应用场景</li>
<li>掌握 Trunk 端口的配置</li>
<li>掌握 Trunk 端口允许所有 VLAN 通过的配置方法</li>
<li>掌握 Trunk 端口允许特定 VLAN 通过的配置方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验背景">实验背景<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%AE%9E%E9%AA%8C%E8%83%8C%E6%99%AF" class="hash-link" aria-label="实验背景的直接链接" title="实验背景的直接链接">​</a></h3>
<p>本实验模拟某公司网络场景。公司规模较大，员工 200 余名，内部网络是一个大的局域网。公司放置了多台接入交换机 (如 S1 和 S2)负责员工的网络接入。接入交换机之间通过汇聚交换机 S3 相连。公司通过划分 VLAN 来隔离广播域，由于员工较多，相同部门的员工通过不同交换机接入。为了保证在不同交换机下相同部门的员工能互相通信需要配置交换机之间链路为干道模式，以实现相同 VLAN 跨交换机通信。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/1-63507dc103634fdf5773dd919acbc9e1.png" width="852" height="556" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验任务配置">实验任务配置<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%AE%9E%E9%AA%8C%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验任务配置的直接链接" title="实验任务配置的直接链接">​</a></h3>
<p><strong>IP 地址规划</strong></p>
<table><thead><tr><th>设备</th><th>接口</th><th>IP地址/掩码</th><th>所属vlan</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>10.1.1.1/24</td><td>10</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>10.1.1.2/24</td><td>20</td></tr><tr><td>PC3</td><td>E0/0/1</td><td>10.1.1.3/24</td><td>10</td></tr><tr><td>PC4</td><td>E0/0/1</td><td>10.1.1.4/24</td><td>20</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h2>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/2-5250c088f146350f00af31a4c9751140.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/3-8a856a559bae563ad549491aa9c86b2d.png" width="781" height="533" class="img_ev3q"></p>
<p><strong>其他主机间互相通信测试和上述相同</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建-vlan">创建 vlan<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E5%88%9B%E5%BB%BA-vlan" class="hash-link" aria-label="创建 vlan的直接链接" title="创建 vlan的直接链接">​</a></h3>
<p>公司内网需要通过VLAN 的划分来隔离不同的部门，需要在3台交换机S1、S2、S3上都分别创建VLAN10和VLAN 20，研发部员工属于VLAN10，市场部员工属于VLAN20。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s1]vlan batch 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2]vlan batch 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s3]vlan batch 10 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置-access-接口">配置 access 接口<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E9%85%8D%E7%BD%AE-access-%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="配置 access 接口的直接链接" title="配置 access 接口的直接链接">​</a></h3>
<p>在S1 上配置E 0/0/2 和E 0/0/3 为Access 接口，并划分到相应的VLAN</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s1-Ethernet0/0/2]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1-Ethernet0/0/2]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1-Ethernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1-Ethernet0/0/3]port default vlan 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S2 上配置E 0/0/3 和E 0/0/4 为Access 接口，并划分到相应的VLAN。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s2-Ethernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2-Ethernet0/0/3]port default vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2-Ethernet0/0/4]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2-Ethernet0/0/4]port default vlan 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置-trunk-接口">配置 trunk 接口<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E9%85%8D%E7%BD%AE-trunk-%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="配置 trunk 接口的直接链接" title="配置 trunk 接口的直接链接">​</a></h3>
<p>为了让交换机间能够识别和发送跨越交换机的VLAN报文，需要将交换机间相连的接口配置成为Trunk接口。配置时要明确被允许通过的VLAN，实现对VLAN流量传输的控制。</p>
<p>在S1上配置E 0/0/1为Trunk 接口，允许VLAN 10 和VLAN20通过</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s1]int eth 0/0/1[s1-Ethernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s1-port-group-link-type]port trunk allow-pass  vlan 10 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S2上配置E 0/0/2为Trunk 接口，允许VLAN 10 和VLAN20通过</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s2]int eth 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2-Ethernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s2-Ethernet0/0/2]port trunk allow-pass  vlan 10 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在S3上配置GE 0/0/1 和GE 0/0/2 为Trunk 接口，允许所有VLAN 通过</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s3]int g 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s3-GigabitEthernet0/0/1]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s3-GigabitEthernet0/0/1]port trunk allow-pass  vlan 10 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s3-GigabitEthernet0/0/1]int g 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s3-GigabitEthernet0/0/2]port link-type trunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[s3-GigabitEthernet0/0/2]port trunk allow-pass vlan 10 20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看trunk-配置情况">查看trunk 配置情况<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E6%9F%A5%E7%9C%8Btrunk-%E9%85%8D%E7%BD%AE%E6%83%85%E5%86%B5" class="hash-link" aria-label="查看trunk 配置情况的直接链接" title="查看trunk 配置情况的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/4-a1719f2c9c27e14e88fb36ed7dd02044.png" width="796" height="124" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="检查配置结果">检查配置结果**<a href="https://ddn.org.cn/hcia/vlan-set-switch-trunk#%E6%A3%80%E6%9F%A5%E9%85%8D%E7%BD%AE%E7%BB%93%E6%9E%9C" class="hash-link" aria-label="检查配置结果**的直接链接" title="检查配置结果**的直接链接">​</a></h2>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/5-0bfe1aeeb119760c800d42b37b15ecf1.png" width="781" height="533" class="img_ev3q"></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/6-10cb0b929d42ec1d10cebc72863dec2a.png" width="781" height="533" class="img_ev3q"></p>
<p><strong>本文完</strong></p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <category label="VLAN" term="VLAN"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[VLAN 基础配置和配置Access 接口]]></title>
        <id>https://ddn.org.cn/hcia/vlan-set-switch-access</id>
        <link href="https://ddn.org.cn/hcia/vlan-set-switch-access"/>
        <updated>2024-01-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[实验介绍:]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验介绍">实验介绍:<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="实验介绍:的直接链接" title="实验介绍:的直接链接">​</a></h2>
<p>关于本实验的所需要的知识点补充</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vlan-部分">vlan 部分<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#vlan-%E9%83%A8%E5%88%86" class="hash-link" aria-label="vlan 部分的直接链接" title="vlan 部分的直接链接">​</a></h3>
<p>VLAN，全称为 Virtual Local Area Network，是一种虚拟局域网技术。它通过在物理网络上进行逻辑划分，将不同的网络设备分组到不同的虚拟局域网中，实现逻辑上的隔离和独立。</p>
<p>传统的局域网是基于物理连接的，所有设备都连接在同一个物理网络上。而 VLAN 技术允许管理员根据不同的需求和安全策略，将设备划分为不同的逻辑组，即虚拟局域网。这样可以实现不同虚拟局域网之间的隔离，提高网络的可管理性和安全性。</p>
<p>VLAN 可以通过端口、MAC 地址、IP 地址等方式进行划分和管理。在同一个物理网络中，不同的 VLAN 之间可以进行通信或隔离，类似于拆分出了多个独立的逻辑网络。这样可以实现更好的网络资源管理、提高带宽利用率、提供更精细的访问控制和安全策略等。</p>
<p>VLAN 技术广泛应用于企业、机构、数据中心等网络环境中，能够提供更灵活、安全和高效的网络划分和管理。</p>
<p>VLAN ID（VLAN 标识符）是用于识别和区分不同 VLAN 的数字标识。每个 VLAN 都被分配一个唯一的 VLAN ID，用于在网络设备之间进行识别和通信。</p>
<p>VLAN ID 是一个 12 位的数字，范围从 1 到 4094。其中，VLAN ID 1 和 VLAN ID 4095 有特殊用途，不能用于常规的用户数据流量。通常，管理员根据网络需求和设计，为不同的 VLAN 分配不同的 VLAN ID。</p>
<p>在网络设备（如交换机）的配置中，将每个端口或接口与特定的 VLAN 关联起来，以确定哪些设备属于哪个 VLAN。当数据包进入交换机时，根据数据包的 VLAN ID 来决定将其发送到哪个 VLAN 中的设备。</p>
<p>VLAN ID 在实现虚拟局域网时起到了关键的作用，它允许网络管理员轻松地将设备划分到不同的逻辑网络中，并为每个 VLAN 提供独立的网络环境和服务。通过使用 VLAN ID，不同 VLAN 之间的数据可以在同一物理网络上进行隔离和转发，提供更高的网络灵活性和管理能力。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-部分">access 部分<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#access-%E9%83%A8%E5%88%86" class="hash-link" aria-label="access 部分的直接链接" title="access 部分的直接链接">​</a></h3>
<p>Access 接口是指网络设备（如交换机）上用于连接终端设备的端口或接口。它是用于连接终端设备（如计算机、IP 电话、摄像头等）到网络的物理接口。</p>
<p>在一个交换机上，通常有多个接口，其中一部分被配置为 Access 接口。Access 接口只能属于一个 VLAN，并且只能传输属于该 VLAN 的数据。终端设备连接到 Access 接口时，数据包会被标记上该接口所属的 VLAN ID，交换机会根据这个标记将数据包发送到相应的 VLAN。Access 接口通常连接到终端设备或其他不需要 VLAN 划分的设备。</p>
<p>通过使用 Access 接口，可以实现对不同终端设备的统一管理和控制。可以为每个 Access 接口配置所属的 VLAN，从而实现终端设备的逻辑划分和隔离。这样可以提高网络的安全性、灵活性和可管理性。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验目的">实验目的<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接">​</a></h3>
<ul>
<li>理解 vlan 的应用场景和基本配置</li>
<li>掌握 access 接口的配置和加入相对应的 vlan 的方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验背景">实验背景<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%AE%9E%E9%AA%8C%E8%83%8C%E6%99%AF" class="hash-link" aria-label="实验背景的直接链接" title="实验背景的直接链接">​</a></h3>
<p>本实验模拟企业网络场景。公司内网是一个大的局域网，二层交换机 S1 放置在一楼，在一楼办公的部门有 IT 部和人事部;二层交换机 S2 放置在二楼，在二楼办公的部门有市场部和研发部。由于交换机组成的是一个广播网，交换机连接的所有主机都能互相通信，而公司策略是:不同部门之间的主机不能互相通信，同一部门内的主机才可以互相访问。因此需要在交换机上划分不同的 VLAN，并将连接主机的交换机接口配置成 Access 接口划分到相应 VLAN 内。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验拓扑">实验拓扑<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%AE%9E%E9%AA%8C%E6%8B%93%E6%89%91" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/1-54e0b4f0a3cdb1278bc5963ae58bd2c6.png" width="829" height="625" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实验任务配置">实验任务配置<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%AE%9E%E9%AA%8C%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="实验任务配置的直接链接" title="实验任务配置的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ip-地址规划">IP 地址规划<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#ip-%E5%9C%B0%E5%9D%80%E8%A7%84%E5%88%92" class="hash-link" aria-label="IP 地址规划的直接链接" title="IP 地址规划的直接链接">​</a></h3>
<table><thead><tr><th>设备</th><th>接口</th><th>IP地址/掩码</th><th>所属vlan</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>10.1.1.1/24</td><td>10</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>10.1.1.2/24</td><td>10</td></tr><tr><td>PC3</td><td>E0/0/1</td><td>10.1.1.3/24</td><td>20</td></tr><tr><td>PC4</td><td>E0/0/1</td><td>10.1.1.4/24</td><td>30</td></tr><tr><td>PC5</td><td>E0/0/1</td><td>10.1.1.5/24</td><td>40</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基本配置">基本配置<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/2-2c0b143b64df4394545aac3dde07f980.png" width="781" height="533" class="img_ev3q">
<img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/3-fe71adc9b1c1b3e5c536754bcc81d32f.png" width="781" height="533" class="img_ev3q">
其他主机间互相通信测试和上述相同，略过。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建-vlan">创建 vlan<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E5%88%9B%E5%BB%BA-vlan" class="hash-link" aria-label="创建 vlan的直接链接" title="创建 vlan的直接链接">​</a></h3>
<p>系统默认分配 vlan1给所有端口，您需要手动新建VLAN。</p>
<ul>
<li>
<p>使⽤vlan [id]命令创建。</p>
</li>
<li>
<p>使用 vlan batch [id] 批量创建。</p>
</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vl 10#或者，您可以使用batch命令一次创建多个VLAN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vlan b 20 30 40 #此处的 batch 可以缩写成 b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置完成后可以使用 <code>display vlan</code> 查看 vlan 信息
<img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/5-850e4750cae7e02d0ffc537ca9e018e0.png" width="1080" height="633" class="img_ev3q">
<img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/6-5414a5d567b942730a3ea9b70b4701ba.png" width="1080" height="555" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置-access-接口">配置 access 接口<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E9%85%8D%E7%BD%AE-access-%E6%8E%A5%E5%8F%A3" class="hash-link" aria-label="配置 access 接口的直接链接" title="配置 access 接口的直接链接">​</a></h3>
<p>连接 PC（终端）的接口必须为 <code>access</code> 类型接口。并使用 <code>port default vlan</code> 命令来加入相应的 vlan 中。
默认情况下，所有接口默认是 <code>vlan 1</code></p>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/7-5752a8dd5c6126de25c916fc5c215653.png" width="374" height="491" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置完成后可以查看-s1-和-s2-上的-vlan-信息">配置完成后可以查看 S1 和 S2 上的 vlan 信息<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90%E5%90%8E%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B-s1-%E5%92%8C-s2-%E4%B8%8A%E7%9A%84-vlan-%E4%BF%A1%E6%81%AF" class="hash-link" aria-label="配置完成后可以查看 S1 和 S2 上的 vlan 信息的直接链接" title="配置完成后可以查看 S1 和 S2 上的 vlan 信息的直接链接">​</a></h3>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/8-2e02af00bd1e9bb362eab836eaa03c28.png" width="1080" height="644" class="img_ev3q">
<img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/9-0efaddbbc96e7c8383203a9f9dc2fadd.png" width="1080" height="675" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="检查配置结果">检查配置结果<a href="https://ddn.org.cn/hcia/vlan-set-switch-access#%E6%A3%80%E6%9F%A5%E9%85%8D%E7%BD%AE%E7%BB%93%E6%9E%9C" class="hash-link" aria-label="检查配置结果的直接链接" title="检查配置结果的直接链接">​</a></h2>
<p><img loading="lazy" alt="图片" src="https://ddn.org.cn/assets/images/10-8aba8d0d7263a98898c4539401f6ceb6.png" width="781" height="533" class="img_ev3q"></p>
<p>在交换机上将不同接口加入各自不同的 VLAN 中后，属于相同 VLAN 的接口处于同一个广播域，相互之间可以直接通信。属于不同 VLAN 的接口是处于不同的广播域，相互之间不能直接通信。</p>]]></content>
        <author>
            <name>Allalone</name>
            <uri>https://space.bilibili.com/21977351</uri>
        </author>
        <author>
            <name>Xinyuu</name>
            <uri>https://space.bilibili.com/142202292</uri>
        </author>
        <category label="VLAN" term="VLAN"/>
        <category label="实验" term="实验"/>
        <category label="交换机" term="交换机"/>
    </entry>
</feed>